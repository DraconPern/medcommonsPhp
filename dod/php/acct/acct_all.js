var hexcase=0;var b64pad="";var chrsz=8;function hex_sha1(B){return binb2hex(core_sha1(str2binb(B),B.length*chrsz))}function b64_sha1(B){return binb2b64(core_sha1(str2binb(B),B.length*chrsz))}function str_sha1(B){return binb2str(core_sha1(str2binb(B),B.length*chrsz))}function hex_hmac_sha1(B,C){return binb2hex(core_hmac_sha1(B,C))}function b64_hmac_sha1(B,C){return binb2b64(core_hmac_sha1(B,C))}function str_hmac_sha1(B,C){return binb2str(core_hmac_sha1(B,C))}function sha1_vm_test(){return hex_sha1("abc")=="a9993e364706816aba3e25717850c26c9cd0d89d"}function core_sha1(O,I){O[I>>5]|=128<<(24-I%32);O[((I+64>>9)<<4)+15]=I;var P=Array(80);var N=1732584193;var M=-271733879;var L=-1732584194;var K=271733878;var J=-1009589776;for(var F=0;F<O.length;F+=16){var H=N;var G=M;var E=L;var D=K;var B=J;for(var C=0;C<80;C++){if(C<16){P[C]=O[F+C]}else{P[C]=rol(P[C-3]^P[C-8]^P[C-14]^P[C-16],1)}var Q=safe_add(safe_add(rol(N,5),sha1_ft(C,M,L,K)),safe_add(safe_add(J,P[C]),sha1_kt(C)));J=K;K=L;L=rol(M,30);M=N;N=Q}N=safe_add(N,H);M=safe_add(M,G);L=safe_add(L,E);K=safe_add(K,D);J=safe_add(J,B)}return Array(N,M,L,K,J)}function sha1_ft(C,B,E,D){if(C<20){return(B&E)|((~B)&D)}if(C<40){return B^E^D}if(C<60){return(B&E)|(B&D)|(E&D)}return B^E^D}function sha1_kt(B){return(B<20)?1518500249:(B<40)?1859775393:(B<60)?-1894007588:-899497514}function core_hmac_sha1(D,G){var F=str2binb(D);if(F.length>16){F=core_sha1(F,D.length*chrsz)}var B=Array(16),E=Array(16);for(var C=0;C<16;C++){B[C]=F[C]^909522486;E[C]=F[C]^1549556828}var H=core_sha1(B.concat(str2binb(G)),512+G.length*chrsz);return core_sha1(E.concat(H),512+160)}function safe_add(B,E){var D=(B&65535)+(E&65535);var C=(B>>16)+(E>>16)+(D>>16);return(C<<16)|(D&65535)}function rol(B,C){return(B<<C)|(B>>>(32-C))}function str2binb(E){var D=Array();var B=(1<<chrsz)-1;for(var C=0;C<E.length*chrsz;C+=chrsz){D[C>>5]|=(E.charCodeAt(C/chrsz)&B)<<(24-C%32)}return D}function binb2str(D){var E="";var B=(1<<chrsz)-1;for(var C=0;C<D.length*32;C+=chrsz){E+=String.fromCharCode((D[C>>5]>>>(24-C%32))&B)}return E}function binb2hex(D){var C=hexcase?"0123456789ABCDEF":"0123456789abcdef";var E="";for(var B=0;B<D.length*4;B++){E+=C.charAt((D[B>>2]>>((3-B%4)*8+4))&15)+C.charAt((D[B>>2]>>((3-B%4)*8))&15)}return E}function binb2b64(E){var D="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";var G="";for(var C=0;C<E.length*4;C+=3){var F=(((E[C>>2]>>8*(3-C%4))&255)<<16)|(((E[C+1>>2]>>8*(3-(C+1)%4))&255)<<8)|((E[C+2>>2]>>8*(3-(C+2)%4))&255);for(var B=0;B<4;B++){if(C*8+B*6>E.length*32){G+=b64pad}else{G+=D.charAt((F>>6*(3-B))&63)}}}return G}var activeSection;function activate(C){if(activeSection){minimize()}activeSection=$(C);hide(C);var B=$(C).getElementsByTagName("div")[0];setMainSectionHeading($(C).getElementsByTagName("h4")[0].innerHTML);$("mainfeature").getElementsByTagName("a")[0].innerHTML="X&nbsp;";$("mainfeature").getElementsByTagName("a")[0].href="javascript:minimize()";show("mainfeature");if(C=="worklist"){$("mainfeatureContents").innerHTML="<iframe name='currentgadget' src='myworklist/?tpl=widget' width='98%' allowtransparency='true' background-color='transparent' frameborder='0' scrolling='no' height='300px'>Your browser doesn't support iframes.</iframe>"}else{$("mainfeatureContents").innerHTML="<iframe name='currentgadget' src='"+C+"/widget.php' width='98%' allowtransparency='true' background-color='transparent' frameborder='0' scrolling='no' height='300px'>Your browser doesn't support iframes.</iframe>"}updateSize()}function setMainSectionHeading(C){var B=$("mainfeature");try{B=window.parent.document.getElementById("mainfeature")}catch(D){}if(B){B.getElementsByTagName("h4")[0].innerHTML=C}else{log("WARN: unable to locate main feature box to set title "+C)}}function minimize(){if(!activeSection){return }hide("mainfeature");show(activeSection.id);updateSize()}function updatePrimaryInterest(){loadJSONDoc("updatePrimaryInterest.php?"+queryString(document.interestsForm)).addCallbacks(function(B){if(B.status=="ok"){alert("Your primary interest has been updated.")}},genericErrorHandler)}if(typeof (dojo)!="undefined"){dojo.provide("MochiKit.Base")}if(typeof (MochiKit)=="undefined"){MochiKit={}}if(typeof (MochiKit.Base)=="undefined"){MochiKit.Base={}}if(typeof (MochiKit.__export__)=="undefined"){MochiKit.__export__=(MochiKit.__compat__||(typeof (JSAN)=="undefined"&&typeof (dojo)=="undefined"))}MochiKit.Base.VERSION="1.4";MochiKit.Base.NAME="MochiKit.Base";MochiKit.Base.update=function(E,D){if(E===null||E===undefined){E={}}for(var C=1;C<arguments.length;C++){var F=arguments[C];if(typeof (F)!="undefined"&&F!==null){for(var B in F){E[B]=F[B]}}}return E};MochiKit.Base.update(MochiKit.Base,{__repr__:function(){return"["+this.NAME+" "+this.VERSION+"]"},toString:function(){return this.__repr__()},camelize:function(C){var B=C.split("-");var E=B[0];for(var D=1;D<B.length;D++){E+=B[D].charAt(0).toUpperCase()+B[D].substring(1)}return E},counter:function(B){if(arguments.length===0){B=1}return function(){return B++}},clone:function(B){var C=arguments.callee;if(arguments.length==1){C.prototype=B;return new C()}},_flattenArray:function(C,B){for(var D=0;D<B.length;D++){var E=B[D];if(E instanceof Array){arguments.callee(C,E)}else{C.push(E)}}return C},flattenArray:function(B){return MochiKit.Base._flattenArray([],B)},flattenArguments:function(C){var E=[];var B=MochiKit.Base;var F=B.extend(null,arguments);while(F.length){var G=F.shift();if(G&&typeof (G)=="object"&&typeof (G.length)=="number"){for(var D=G.length-1;D>=0;D--){F.unshift(G[D])}}else{E.push(G)}}return E},extend:function(C,F,E){if(!E){E=0}if(F){var B=F.length;if(typeof (B)!="number"){if(typeof (MochiKit.Iter)!="undefined"){F=MochiKit.Iter.list(F);B=F.length}else{throw new TypeError("Argument not an array-like and MochiKit.Iter not present")}}if(!C){C=[]}for(var D=E;D<B;D++){C.push(F[D])}}return C},updatetree:function(D,F){if(D===null||D===undefined){D={}}for(var E=1;E<arguments.length;E++){var G=arguments[E];if(typeof (G)!="undefined"&&G!==null){for(var C in G){var B=G[C];if(typeof (D[C])=="object"&&typeof (B)=="object"){arguments.callee(D[C],B)}else{D[C]=B}}}}return D},setdefault:function(F,D){if(F===null||F===undefined){F={}}for(var C=1;C<arguments.length;C++){var E=arguments[C];for(var B in E){if(!(B in F)){F[B]=E[B]}}}return F},keys:function(D){var B=[];for(var C in D){B.push(C)}return B},values:function(D){var C=[];for(var B in D){C.push(D[B])}return C},items:function(F){var D=[];var E;for(var C in F){var B;try{B=F[C]}catch(E){continue}D.push([C,B])}return D},_newNamedError:function(B,D,C){C.prototype=new MochiKit.Base.NamedError(B.NAME+"."+D);B[D]=C},operator:{truth:function(B){return !!B},lognot:function(B){return !B},identity:function(B){return B},not:function(B){return ~B},neg:function(B){return -B},add:function(C,B){return C+B},sub:function(C,B){return C-B},div:function(C,B){return C/B},mod:function(C,B){return C%B},mul:function(C,B){return C*B},and:function(C,B){return C&B},or:function(C,B){return C|B},xor:function(C,B){return C^B},lshift:function(C,B){return C<<B},rshift:function(C,B){return C>>B},zrshift:function(C,B){return C>>>B},eq:function(C,B){return C==B},ne:function(C,B){return C!=B},gt:function(C,B){return C>B},ge:function(C,B){return C>=B},lt:function(C,B){return C<B},le:function(C,B){return C<=B},seq:function(C,B){return C===B},sne:function(C,B){return C!==B},ceq:function(C,B){return MochiKit.Base.compare(C,B)===0},cne:function(C,B){return MochiKit.Base.compare(C,B)!==0},cgt:function(C,B){return MochiKit.Base.compare(C,B)==1},cge:function(C,B){return MochiKit.Base.compare(C,B)!=-1},clt:function(C,B){return MochiKit.Base.compare(C,B)==-1},cle:function(C,B){return MochiKit.Base.compare(C,B)!=1},logand:function(C,B){return C&&B},logor:function(C,B){return C||B},contains:function(C,B){return B in C}},forwardCall:function(B){return function(){return this[B].apply(this,arguments)}},itemgetter:function(B){return function(C){return C[B]}},typeMatcher:function(){var C={};for(var B=0;B<arguments.length;B++){var D=arguments[B];C[D]=D}return function(){for(var E=0;E<arguments.length;E++){if(!(typeof (arguments[E]) in C)){return false}}return true}},isNull:function(){for(var B=0;B<arguments.length;B++){if(arguments[B]!==null){return false}}return true},isUndefinedOrNull:function(){for(var B=0;B<arguments.length;B++){var C=arguments[B];if(!(typeof (C)=="undefined"||C===null)){return false}}return true},isEmpty:function(B){return !MochiKit.Base.isNotEmpty.apply(this,arguments)},isNotEmpty:function(C){for(var B=0;B<arguments.length;B++){var D=arguments[B];if(!(D&&D.length)){return false}}return true},isArrayLike:function(){for(var B=0;B<arguments.length;B++){var D=arguments[B];var C=typeof (D);if((C!="object"&&!(C=="function"&&typeof (D.item)=="function"))||D===null||typeof (D.length)!="number"||D.nodeType===3){return false}}return true},isDateLike:function(){for(var B=0;B<arguments.length;B++){var C=arguments[B];if(typeof (C)!="object"||C===null||typeof (C.getTime)!="function"){return false}}return true},xmap:function(C){if(C===null){return MochiKit.Base.extend(null,arguments,1)}var D=[];for(var B=1;B<arguments.length;B++){D.push(C(arguments[B]))}return D},map:function(I,F){var B=MochiKit.Base;var G=MochiKit.Iter;var L=B.isArrayLike;if(arguments.length<=2){if(!L(F)){if(G){F=G.list(F);if(I===null){return F}}else{throw new TypeError("Argument not an array-like and MochiKit.Iter not present")}}if(I===null){return B.extend(null,F)}var K=[];for(var E=0;E<F.length;E++){K.push(I(F[E]))}return K}else{if(I===null){I=Array}var J=null;for(E=1;E<arguments.length;E++){if(!L(arguments[E])){if(G){return G.list(G.imap.apply(null,arguments))}else{throw new TypeError("Argument not an array-like and MochiKit.Iter not present")}}var C=arguments[E].length;if(J===null||J>C){J=C}}K=[];for(E=0;E<J;E++){var H=[];for(var D=1;D<arguments.length;D++){H.push(arguments[D][E])}K.push(I.apply(this,H))}return K}},xfilter:function(C){var E=[];if(C===null){C=MochiKit.Base.operator.truth}for(var B=1;B<arguments.length;B++){var D=arguments[B];if(C(D)){E.push(D)}}return E},filter:function(E,C,H){var G=[];var B=MochiKit.Base;if(!B.isArrayLike(C)){if(MochiKit.Iter){C=MochiKit.Iter.list(C)}else{throw new TypeError("Argument not an array-like and MochiKit.Iter not present")}}if(E===null){E=B.operator.truth}if(typeof (Array.prototype.filter)=="function"){return Array.prototype.filter.call(C,E,H)}else{if(typeof (H)=="undefined"||H===null){for(var D=0;D<C.length;D++){var F=C[D];if(E(F)){G.push(F)}}}else{for(D=0;D<C.length;D++){F=C[D];if(E.call(H,F)){G.push(F)}}}}return G},_wrapDumbFunction:function(_9f){return function(){switch(arguments.length){case 0:return _9f();case 1:return _9f(arguments[0]);case 2:return _9f(arguments[0],arguments[1]);case 3:return _9f(arguments[0],arguments[1],arguments[2])}var _a0=[];for(var i=0;i<arguments.length;i++){_a0.push("arguments["+i+"]")}return eval("(func("+_a0.join(",")+"))")}},methodcaller:function(C){var B=MochiKit.Base.extend(null,arguments,1);if(typeof (C)=="function"){return function(D){return C.apply(D,B)}}else{return function(D){return D[C].apply(D,B)}}},method:function(D,C){var B=MochiKit.Base;return B.bind.apply(this,B.extend([C,D],arguments,2))},compose:function(C,G){var D=[];var B=MochiKit.Base;if(arguments.length===0){throw new TypeError("compose() requires at least one argument")}for(var E=0;E<arguments.length;E++){var F=arguments[E];if(typeof (F)!="function"){throw new TypeError(B.repr(F)+" is not a function")}D.push(F)}return function(){var I=arguments;for(var H=D.length-1;H>=0;H--){I=[D[H].apply(this,I)]}return I[0]}},bind:function(H,G){if(typeof (H)=="string"){H=G[H]}var F=H.im_func;var E=H.im_preargs;var D=H.im_self;var B=MochiKit.Base;if(typeof (H)=="function"&&typeof (H.apply)=="undefined"){H=B._wrapDumbFunction(H)}if(typeof (F)!="function"){F=H}if(typeof (G)!="undefined"){D=G}if(typeof (E)=="undefined"){E=[]}else{E=E.slice()}B.extend(E,arguments,2);var C=function(){var I=arguments;var K=arguments.callee;if(K.im_preargs.length>0){I=B.concat(K.im_preargs,I)}var J=K.im_self;if(!J){J=this}return K.im_func.apply(J,I)};C.im_self=D;C.im_func=F;C.im_preargs=E;return C},bindMethods:function(E){var D=MochiKit.Base.bind;for(var C in E){var B=E[C];if(typeof (B)=="function"){E[C]=D(B,E)}}},registerComparator:function(E,B,D,C){MochiKit.Base.comparatorRegistry.register(E,B,D,C)},_primitives:{"boolean":true,string:true,number:true},compare:function(D,C){if(D==C){return 0}var H=(typeof (D)=="undefined"||D===null);var G=(typeof (C)=="undefined"||C===null);if(H&&G){return 0}else{if(H){return -1}else{if(G){return 1}}}var B=MochiKit.Base;var F=B._primitives;if(!(typeof (D) in F&&typeof (C) in F)){try{return B.comparatorRegistry.match(D,C)}catch(I){if(I!=B.NotFound){throw I}}}if(D<C){return -1}else{if(D>C){return 1}}var E=B.repr;throw new TypeError(E(D)+" and "+E(C)+" can not be compared")},compareDateLike:function(C,B){return MochiKit.Base.compare(C.getTime(),B.getTime())},compareArrayLike:function(D,B){var F=MochiKit.Base.compare;var C=D.length;var E=0;if(C>B.length){E=1;C=B.length}else{if(C<B.length){E=-1}}for(var G=0;G<C;G++){var H=F(D[G],B[G]);if(H){return H}}return E},registerRepr:function(E,D,C,B){MochiKit.Base.reprRegistry.register(E,D,C,B)},repr:function(E){if(typeof (E)=="undefined"){return"undefined"}else{if(E===null){return"null"}}try{if(typeof (E.__repr__)=="function"){return E.__repr__()}else{if(typeof (E.repr)=="function"&&E.repr!=arguments.callee){return E.repr()}}return MochiKit.Base.reprRegistry.match(E)}catch(D){if(typeof (E.NAME)=="string"&&(E.toString==Function.prototype.toString||E.toString==Object.prototype.toString)){return E.NAME}}try{var C=(E+"")}catch(D){return"["+typeof (E)+"]"}if(typeof (E)=="function"){C=C.replace(/^\s+/,"").replace(/\s+/g," ");var B=C.indexOf("{");if(B!=-1){C=C.substr(0,B)+"{...}"}}return C},reprArrayLike:function(C){var B=MochiKit.Base;return"["+B.map(B.repr,C).join(", ")+"]"},reprString:function(B){return('"'+B.replace(/(["\\])/g,"\\$1")+'"').replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r")},reprNumber:function(B){return B+""},registerJSON:function(E,C,D,B){MochiKit.Base.jsonRegistry.register(E,C,D,B)},evalJSON:function(){return eval("("+MochiKit.Base._filterJSON(arguments[0])+")")},_filterJSON:function(C){var B=C.match(/^\s*\/\*(.*)\*\/\s*$/);if(B){return B[1]}return C},serializeJSON:function(E){var G=typeof (E);if(G=="number"||G=="boolean"){return E+""}else{if(E===null){return"null"}}var H=MochiKit.Base;var D=H.reprString;if(G=="string"){return D(E)}var M=arguments.callee;var B;if(typeof (E.__json__)=="function"){B=E.__json__();if(E!==B){return M(B)}}if(typeof (E.json)=="function"){B=E.json();if(E!==B){return M(B)}}if(G!="function"&&typeof (E.length)=="number"){var L=[];for(var J=0;J<E.length;J++){var F=M(E[J]);if(typeof (F)!="string"){F="undefined"}L.push(F)}return"["+L.join(", ")+"]"}try{B=H.jsonRegistry.match(E);if(E!==B){return M(B)}}catch(K){if(K!=H.NotFound){throw K}}if(G=="undefined"){throw new TypeError("undefined can not be serialized as JSON")}if(G=="function"){return null}L=[];for(var I in E){var C;if(typeof (I)=="number"){C='"'+I+'"'}else{if(typeof (I)=="string"){C=D(I)}else{continue}}F=M(E[I]);if(typeof (F)!="string"){continue}L.push(C+":"+F)}return"{"+L.join(", ")+"}"},objEqual:function(C,B){return(MochiKit.Base.compare(C,B)===0)},arrayEqual:function(C,B){if(C.length!=B.length){return false}return(MochiKit.Base.compare(C,B)===0)},concat:function(){var C=[];var B=MochiKit.Base.extend;for(var D=0;D<arguments.length;D++){B(C,arguments[D])}return C},keyComparator:function(D){var C=MochiKit.Base;var E=C.compare;if(arguments.length==1){return function(G,F){return E(G[D],F[D])}}var B=C.extend(null,arguments);return function(G,F){var J=0;for(var I=0;(J===0)&&(I<B.length);I++){var H=B[I];J=E(G[H],F[H])}return J}},reverseKeyComparator:function(C){var B=MochiKit.Base.keyComparator.apply(this,arguments);return function(E,D){return B(D,E)}},partial:function(C){var B=MochiKit.Base;return B.bind.apply(this,B.extend([C,undefined],arguments,1))},listMinMax:function(G,B){if(B.length===0){return null}var F=B[0];var C=MochiKit.Base.compare;for(var D=1;D<B.length;D++){var E=B[D];if(C(E,F)==G){F=E}}return F},objMax:function(){return MochiKit.Base.listMinMax(1,arguments)},objMin:function(){return MochiKit.Base.listMinMax(-1,arguments)},findIdentical:function(B,F,E,C){if(typeof (C)=="undefined"||C===null){C=B.length}if(typeof (E)=="undefined"||E===null){E=0}for(var D=E;D<C;D++){if(B[D]===F){return D}}return -1},mean:function(){var F=0;var B=MochiKit.Base;var D=B.extend(null,arguments);var C=D.length;while(D.length){var G=D.shift();if(G&&typeof (G)=="object"&&typeof (G.length)=="number"){C+=G.length-1;for(var E=G.length-1;E>=0;E--){F+=G[E]}}else{F+=G}}if(C<=0){throw new TypeError("mean() requires at least one argument")}return F/C},median:function(){var B=MochiKit.Base.flattenArguments(arguments);if(B.length===0){throw new TypeError("median() requires at least one argument")}B.sort(compare);if(B.length%2==0){var C=B.length/2;return(B[C]+B[C-1])/2}else{return B[(B.length-1)/2]}},findValue:function(B,E,D,C){if(typeof (C)=="undefined"||C===null){C=B.length}if(typeof (D)=="undefined"||D===null){D=0}var G=MochiKit.Base.compare;for(var F=D;F<C;F++){if(G(B[F],E)===0){return F}}return -1},nodeWalk:function(C,F){var E=[C];var D=MochiKit.Base.extend;while(E.length){var B=F(E.shift());if(B){D(E,B)}}},nameFunctions:function(C){var D=C.NAME;if(typeof (D)=="undefined"){D=""}else{D=D+"."}for(var B in C){var F=C[B];if(typeof (F)=="function"&&typeof (F.NAME)=="undefined"){try{F.NAME=D+B}catch(E){}}}},queryString:function(K,C){if(typeof (MochiKit.DOM)!="undefined"&&arguments.length==1&&(typeof (K)=="string"||(typeof (K.nodeType)!="undefined"&&K.nodeType>0))){var H=MochiKit.DOM.formContents(K);K=H[0];C=H[1]}else{if(arguments.length==1){if(typeof (K.length)=="number"&&K.length==2){return arguments.callee(K[0],K[1])}var B=K;K=[];C=[];for(var D in B){var I=B[D];if(typeof (I)=="function"){continue}else{if(MochiKit.Base.isArrayLike(I)){for(var E=0;E<I.length;E++){K.push(D);C.push(I[E])}}else{K.push(D);C.push(I)}}}}}var F=[];var G=Math.min(K.length,C.length);var J=MochiKit.Base.urlEncode;for(var E=0;E<G;E++){I=C[E];if(typeof (I)!="undefined"&&I!==null){F.push(J(K[E])+"="+J(I))}}return F.join("&")},parseQueryString:function(K,J){var D=(K.charAt(0)=="?")?K.substring(1):K;var I=D.replace(/\+/g,"%20").split(/(\&amp\;|\&\#38\;|\&#x26;|\&)/);var C={};var H;if(typeof (decodeURIComponent)!="undefined"){H=decodeURIComponent}else{H=unescape}if(J){for(var F=0;F<I.length;F++){var E=I[F].split("=");var B=H(E.shift());if(!B){continue}var G=C[B];if(!(G instanceof Array)){G=[];C[B]=G}G.push(H(E.join("=")))}}else{for(F=0;F<I.length;F++){E=I[F].split("=");var B=E.shift();if(!B){continue}C[H(B)]=H(E.join("="))}}return C}});MochiKit.Base.AdapterRegistry=function(){this.pairs=[]};MochiKit.Base.AdapterRegistry.prototype={register:function(D,C,E,B){if(B){this.pairs.unshift([D,C,E])}else{this.pairs.push([D,C,E])}},match:function(){for(var B=0;B<this.pairs.length;B++){var C=this.pairs[B];if(C[1].apply(this,arguments)){return C[2].apply(this,arguments)}}throw MochiKit.Base.NotFound},unregister:function(B){for(var C=0;C<this.pairs.length;C++){var D=this.pairs[C];if(D[0]==B){this.pairs.splice(C,1);return true}}return false}};MochiKit.Base.EXPORT=["flattenArray","noop","camelize","counter","clone","extend","update","updatetree","setdefault","keys","values","items","NamedError","operator","forwardCall","itemgetter","typeMatcher","isCallable","isUndefined","isUndefinedOrNull","isNull","isEmpty","isNotEmpty","isArrayLike","isDateLike","xmap","map","xfilter","filter","methodcaller","compose","bind","bindMethods","NotFound","AdapterRegistry","registerComparator","compare","registerRepr","repr","objEqual","arrayEqual","concat","keyComparator","reverseKeyComparator","partial","merge","listMinMax","listMax","listMin","objMax","objMin","nodeWalk","zip","urlEncode","queryString","serializeJSON","registerJSON","evalJSON","parseQueryString","findValue","findIdentical","flattenArguments","method","average","mean","median"];MochiKit.Base.EXPORT_OK=["nameFunctions","comparatorRegistry","reprRegistry","jsonRegistry","compareDateLike","compareArrayLike","reprArrayLike","reprString","reprNumber"];MochiKit.Base._exportSymbols=function(E,D){if(!MochiKit.__export__){return }var C=D.EXPORT_TAGS[":all"];for(var B=0;B<C.length;B++){E[C[B]]=D[C[B]]}};MochiKit.Base.__new__=function(){var B=this;B.noop=B.operator.identity;B.forward=B.forwardCall;B.find=B.findValue;if(typeof (encodeURIComponent)!="undefined"){B.urlEncode=function(D){return encodeURIComponent(D).replace(/\'/g,"%27")}}else{B.urlEncode=function(D){return escape(D).replace(/\+/g,"%2B").replace(/\"/g,"%22").rval.replace(/\'/g,"%27")}}B.NamedError=function(D){this.message=D;this.name=D};B.NamedError.prototype=new Error();B.update(B.NamedError.prototype,{repr:function(){if(this.message&&this.message!=this.name){return this.name+"("+B.repr(this.message)+")"}else{return this.name+"()"}},toString:B.forwardCall("repr")});B.NotFound=new B.NamedError("MochiKit.Base.NotFound");B.listMax=B.partial(B.listMinMax,1);B.listMin=B.partial(B.listMinMax,-1);B.isCallable=B.typeMatcher("function");B.isUndefined=B.typeMatcher("undefined");B.merge=B.partial(B.update,null);B.zip=B.partial(B.map,null);B.average=B.mean;B.comparatorRegistry=new B.AdapterRegistry();B.registerComparator("dateLike",B.isDateLike,B.compareDateLike);B.registerComparator("arrayLike",B.isArrayLike,B.compareArrayLike);B.reprRegistry=new B.AdapterRegistry();B.registerRepr("arrayLike",B.isArrayLike,B.reprArrayLike);B.registerRepr("string",B.typeMatcher("string"),B.reprString);B.registerRepr("numbers",B.typeMatcher("number","boolean"),B.reprNumber);B.jsonRegistry=new B.AdapterRegistry();var C=B.concat(B.EXPORT,B.EXPORT_OK);B.EXPORT_TAGS={":common":B.concat(B.EXPORT_OK),":all":C};B.nameFunctions(this)};MochiKit.Base.__new__();if(MochiKit.__export__){compare=MochiKit.Base.compare;compose=MochiKit.Base.compose;serializeJSON=MochiKit.Base.serializeJSON;mean=MochiKit.Base.mean;median=MochiKit.Base.median}MochiKit.Base._exportSymbols(this,MochiKit.Base);if(typeof (dojo)!="undefined"){dojo.provide("MochiKit.Iter");dojo.require("MochiKit.Base")}if(typeof (JSAN)!="undefined"){JSAN.use("MochiKit.Base",[])}try{if(typeof (MochiKit.Base)=="undefined"){throw""}}catch(e){throw"MochiKit.Iter depends on MochiKit.Base!"}if(typeof (MochiKit.Iter)=="undefined"){MochiKit.Iter={}}MochiKit.Iter.NAME="MochiKit.Iter";MochiKit.Iter.VERSION="1.4";MochiKit.Base.update(MochiKit.Iter,{__repr__:function(){return"["+this.NAME+" "+this.VERSION+"]"},toString:function(){return this.__repr__()},registerIteratorFactory:function(C,E,D,B){MochiKit.Iter.iteratorRegistry.register(C,E,D,B)},iter:function(E,C){var D=MochiKit.Iter;if(arguments.length==2){return D.takewhile(function(G){return G!=C},E)}if(typeof (E.next)=="function"){return E}else{if(typeof (E.iter)=="function"){return E.iter()}}try{return D.iteratorRegistry.match(E)}catch(F){var B=MochiKit.Base;if(F==B.NotFound){F=new TypeError(typeof (E)+": "+B.repr(E)+" is not iterable")}throw F}},count:function(C){if(!C){C=0}var B=MochiKit.Base;return{repr:function(){return"count("+C+")"},toString:B.forwardCall("repr"),next:B.counter(C)}},cycle:function(F){var D=MochiKit.Iter;var C=MochiKit.Base;var B=[];var E=D.iter(F);return{repr:function(){return"cycle(...)"},toString:C.forwardCall("repr"),next:function(){try{var I=E.next();B.push(I);return I}catch(H){if(H!=D.StopIteration){throw H}if(B.length===0){this.next=function(){throw D.StopIteration}}else{var G=-1;this.next=function(){G=(G+1)%B.length;return B[G]}}return this.next()}}}},repeat:function(C,D){var B=MochiKit.Base;if(typeof (D)=="undefined"){return{repr:function(){return"repeat("+B.repr(C)+")"},toString:B.forwardCall("repr"),next:function(){return C}}}return{repr:function(){return"repeat("+B.repr(C)+", "+D+")"},toString:B.forwardCall("repr"),next:function(){if(D<=0){throw MochiKit.Iter.StopIteration}D-=1;return C}}},next:function(B){return B.next()},izip:function(G,F){var B=MochiKit.Base;var D=MochiKit.Iter;var E=D.next;var C=B.map(D.iter,arguments);return{repr:function(){return"izip(...)"},toString:B.forwardCall("repr"),next:function(){return B.map(E,C)}}},ifilter:function(D,C){var B=MochiKit.Base;C=MochiKit.Iter.iter(C);if(D===null){D=B.operator.truth}return{repr:function(){return"ifilter(...)"},toString:B.forwardCall("repr"),next:function(){while(true){var E=C.next();if(D(E)){return E}}return undefined}}},ifilterfalse:function(D,C){var B=MochiKit.Base;C=MochiKit.Iter.iter(C);if(D===null){D=B.operator.truth}return{repr:function(){return"ifilterfalse(...)"},toString:B.forwardCall("repr"),next:function(){while(true){var E=C.next();if(!D(E)){return E}}return undefined}}},islice:function(D){var C=MochiKit.Iter;var B=MochiKit.Base;D=C.iter(D);var E=0;var G=0;var H=1;var F=-1;if(arguments.length==2){G=arguments[1]}else{if(arguments.length==3){E=arguments[1];G=arguments[2]}else{E=arguments[1];G=arguments[2];H=arguments[3]}}return{repr:function(){return"islice("+["...",E,G,H].join(", ")+")"},toString:B.forwardCall("repr"),next:function(){var I;while(F<E){I=D.next();F++}if(E>=G){throw C.StopIteration}E+=H;return I}}},imap:function(D,I,G){var C=MochiKit.Base;var E=MochiKit.Iter;var B=C.map(E.iter,C.extend(null,arguments,1));var H=C.map;var F=E.next;return{repr:function(){return"imap(...)"},toString:C.forwardCall("repr"),next:function(){return D.apply(this,H(F,B))}}},applymap:function(C,E,D){E=MochiKit.Iter.iter(E);var B=MochiKit.Base;return{repr:function(){return"applymap(...)"},toString:B.forwardCall("repr"),next:function(){return C.apply(D,E.next())}}},chain:function(F,E){var C=MochiKit.Iter;var B=MochiKit.Base;if(arguments.length==1){return C.iter(arguments[0])}var D=B.map(C.iter,arguments);return{repr:function(){return"chain(...)"},toString:B.forwardCall("repr"),next:function(){while(D.length>1){try{return D[0].next()}catch(H){if(H!=C.StopIteration){throw H}D.shift()}}if(D.length==1){var G=D.shift();this.next=B.bind("next",G);return this.next()}throw C.StopIteration}}},takewhile:function(D,C){var B=MochiKit.Iter;C=B.iter(C);return{repr:function(){return"takewhile(...)"},toString:MochiKit.Base.forwardCall("repr"),next:function(){var E=C.next();if(!D(E)){this.next=function(){throw B.StopIteration};this.next()}return E}}},dropwhile:function(D,C){C=MochiKit.Iter.iter(C);var B=MochiKit.Base;var E=B.bind;return{repr:function(){return"dropwhile(...)"},toString:B.forwardCall("repr"),next:function(){while(true){var F=C.next();if(!D(F)){break}}this.next=E("next",C);return F}}},_tee:function(E,D,C){D.pos[E]=-1;var B=MochiKit.Base;var F=B.listMin;return{repr:function(){return"tee("+E+", ...)"},toString:B.forwardCall("repr"),next:function(){var H;var G=D.pos[E];if(G==D.max){H=C.next();D.deque.push(H);D.max+=1;D.pos[E]+=1}else{H=D.deque[G-D.min];D.pos[E]+=1;if(G==D.min&&F(D.pos)!=D.min){D.min+=1;D.deque.shift()}}return H}}},tee:function(E,H){var G=[];var F={pos:[],deque:[],max:-1,min:-1};if(arguments.length==1||typeof (H)=="undefined"||H===null){H=2}var C=MochiKit.Iter;E=C.iter(E);var B=C._tee;for(var D=0;D<H;D++){G.push(B(D,F,E))}return G},list:function(B){var F;if(B instanceof Array){return B.slice()}if(typeof (B)=="function"&&!(B instanceof Function)&&typeof (B.length)=="number"){F=[];for(var D=0;D<B.length;D++){F.push(B[D])}return F}var C=MochiKit.Iter;B=C.iter(B);var F=[];try{while(true){F.push(B.next())}}catch(E){if(E!=C.StopIteration){throw E}return F}return undefined},reduce:function(F,G,C){var E=0;var B=C;var D=MochiKit.Iter;G=D.iter(G);if(arguments.length<3){try{B=G.next()}catch(H){if(H==D.StopIteration){H=new TypeError("reduce() of empty sequence with no initial value")}throw H}E++}try{while(true){B=F(B,G.next())}}catch(H){if(H!=D.StopIteration){throw H}}return B},range:function(){var D=0;var B=0;var C=1;if(arguments.length==1){B=arguments[0]}else{if(arguments.length==2){D=arguments[0];B=arguments[1]}else{if(arguments.length==3){D=arguments[0];B=arguments[1];C=arguments[2]}else{throw new TypeError("range() takes 1, 2, or 3 arguments!")}}}if(C===0){throw new TypeError("range() step must not be 0")}return{next:function(){if((C>0&&D>=B)||(C<0&&D<=B)){throw MochiKit.Iter.StopIteration}var E=D;D+=C;return E},repr:function(){return"range("+[D,B,C].join(", ")+")"},toString:MochiKit.Base.forwardCall("repr")}},sum:function(E,D){if(typeof (D)=="undefined"||D===null){D=0}var B=D;var C=MochiKit.Iter;E=C.iter(E);try{while(true){B+=E.next()}}catch(F){if(F!=C.StopIteration){throw F}}return B},exhaust:function(B){var C=MochiKit.Iter;B=C.iter(B);try{while(true){B.next()}}catch(D){if(D!=C.StopIteration){throw D}}},forEach:function(G,E,C){var B=MochiKit.Base;if(arguments.length>2){E=B.bind(E,C)}if(B.isArrayLike(G)){try{for(var D=0;D<G.length;D++){E(G[D])}}catch(F){if(F!=MochiKit.Iter.StopIteration){throw F}}}else{C=MochiKit.Iter;C.exhaust(C.imap(E,G))}},every:function(E,C){var B=MochiKit.Iter;try{B.ifilterfalse(C,E).next();return false}catch(D){if(D!=B.StopIteration){throw D}return true}},sorted:function(D,B){var C=MochiKit.Iter.list(D);if(arguments.length==1){B=MochiKit.Base.compare}C.sort(B);return C},reversed:function(B){var C=MochiKit.Iter.list(B);C.reverse();return C},some:function(C,D){var B=MochiKit.Iter;try{B.ifilter(D,C).next();return true}catch(E){if(E!=B.StopIteration){throw E}return false}},iextend:function(C,B){if(MochiKit.Base.isArrayLike(B)){for(var E=0;E<B.length;E++){C.push(B[E])}}else{var D=MochiKit.Iter;B=D.iter(B);try{while(true){C.push(B.next())}}catch(F){if(F!=D.StopIteration){throw F}}}return C},groupby:function(D,C){var F=MochiKit.Base;var L=MochiKit.Iter;if(arguments.length<2){C=F.operator.identity}D=L.iter(D);var H=undefined;var G=undefined;var K;function B(){K=D.next();G=C(K)}function E(){var M=K;K=undefined;return M}var J=true;var I=F.compare;return{repr:function(){return"groupby(...)"},next:function(){while(I(G,H)===0){B();if(J){J=false;break}}H=G;return[G,{next:function(){if(K==undefined){B()}if(I(G,H)!==0){throw L.StopIteration}return E()}}]}}},groupby_as_array:function(G,F){var B=MochiKit.Base;var M=MochiKit.Iter;if(arguments.length<2){F=B.operator.identity}G=M.iter(G);var L=[];var J=true;var I;var H=B.compare;while(true){try{var E=G.next();var K=F(E)}catch(C){if(C==M.StopIteration){break}throw C}if(J||H(K,I)!==0){var D=[];L.push([K,D])}D.push(E);J=false;I=K}return L},arrayLikeIter:function(B){var C=0;return{repr:function(){return"arrayLikeIter(...)"},toString:MochiKit.Base.forwardCall("repr"),next:function(){if(C>=B.length){throw MochiKit.Iter.StopIteration}return B[C++]}}},hasIterateNext:function(B){return(B&&typeof (B.iterateNext)=="function")},iterateNextIter:function(B){return{repr:function(){return"iterateNextIter(...)"},toString:MochiKit.Base.forwardCall("repr"),next:function(){var C=B.iterateNext();if(C===null||C===undefined){throw MochiKit.Iter.StopIteration}return C}}}});MochiKit.Iter.EXPORT_OK=["iteratorRegistry","arrayLikeIter","hasIterateNext","iterateNextIter"];MochiKit.Iter.EXPORT=["StopIteration","registerIteratorFactory","iter","count","cycle","repeat","next","izip","ifilter","ifilterfalse","islice","imap","applymap","chain","takewhile","dropwhile","tee","list","reduce","range","sum","exhaust","forEach","every","sorted","reversed","some","iextend","groupby","groupby_as_array"];MochiKit.Iter.__new__=function(){var B=MochiKit.Base;if(typeof (StopIteration)!="undefined"){this.StopIteration=StopIteration}else{this.StopIteration=new B.NamedError("StopIteration")}this.iteratorRegistry=new B.AdapterRegistry();this.registerIteratorFactory("arrayLike",B.isArrayLike,this.arrayLikeIter);this.registerIteratorFactory("iterateNext",this.hasIterateNext,this.iterateNextIter);this.EXPORT_TAGS={":common":this.EXPORT,":all":B.concat(this.EXPORT,this.EXPORT_OK)};B.nameFunctions(this)};MochiKit.Iter.__new__();if(MochiKit.__export__){reduce=MochiKit.Iter.reduce}MochiKit.Base._exportSymbols(this,MochiKit.Iter);if(typeof (dojo)!="undefined"){dojo.provide("MochiKit.DOM");dojo.require("MochiKit.Base")}if(typeof (JSAN)!="undefined"){JSAN.use("MochiKit.Base",[])}try{if(typeof (MochiKit.Base)=="undefined"){throw""}}catch(e){throw"MochiKit.DOM depends on MochiKit.Base!"}if(typeof (MochiKit.DOM)=="undefined"){MochiKit.DOM={}}MochiKit.DOM.NAME="MochiKit.DOM";MochiKit.DOM.VERSION="1.4";MochiKit.DOM.__repr__=function(){return"["+this.NAME+" "+this.VERSION+"]"};MochiKit.DOM.toString=function(){return this.__repr__()};MochiKit.DOM.EXPORT=["removeEmptyTextNodes","formContents","currentWindow","currentDocument","withWindow","withDocument","registerDOMConverter","coerceToDOM","createDOM","createDOMFunc","isChildNode","getNodeAttribute","removeNodeAttribute","setNodeAttribute","updateNodeAttributes","appendChildNodes","insertSiblingNodesAfter","insertSiblingNodesBefore","replaceChildNodes","removeElement","swapDOM","BUTTON","TT","PRE","H1","H2","H3","BR","CANVAS","HR","LABEL","TEXTAREA","FORM","STRONG","SELECT","OPTION","OPTGROUP","LEGEND","FIELDSET","P","UL","OL","LI","TD","TR","THEAD","TBODY","TFOOT","TABLE","TH","INPUT","SPAN","A","DIV","IMG","getElement","$","getElementsByTagAndClassName","addToCallStack","addLoadEvent","focusOnLoad","setElementClass","toggleElementClass","addElementClass","removeElementClass","swapElementClass","hasElementClass","escapeHTML","toHTML","emitHTML","scrapeText","isParent","getFirstParentByTagAndClassName","makeClipping","undoClipping","makePositioned","undoPositioned","getFirstElementByTagAndClassName"];MochiKit.DOM.EXPORT_OK=["domConverters"];MochiKit.DOM.DEPRECATED=[["computedStyle","MochiKit.Style.getStyle","1.4"],["elementDimensions","MochiKit.Style.getElementDimensions","1.4"],["elementPosition","MochiKit.Style.getElementPosition","1.4"],["hideElement","MochiKit.Style.hideElement","1.4"],["setElementDimensions","MochiKit.Style.setElementDimensions","1.4"],["setElementPosition","MochiKit.Style.setElementPosition","1.4"],["setDisplayForElement","MochiKit.Style.setDisplayForElement","1.4"],["setOpacity","MochiKit.Style.setOpacity","1.4"],["showElement","MochiKit.Style.showElement","1.4"],["Coordinates","MochiKit.Style.Coordinates","1.4"],["Dimensions","MochiKit.Style.Dimensions","1.4"]];MochiKit.DOM.getViewportDimensions=new Function('if (!MochiKit["Style"]) {    throw new Error("This function has been deprecated and depends on MochiKit.Style.");}return MochiKit.Style.getViewportDimensions.apply(this, arguments);');MochiKit.Base.update(MochiKit.DOM,{currentWindow:function(){return MochiKit.DOM._window},currentDocument:function(){return MochiKit.DOM._document},withWindow:function(H,C){var B=MochiKit.DOM;var G=B._document;var D=B._window;var F;try{B._window=H;B._document=H.document;F=C()}catch(E){B._window=D;B._document=G;throw E}B._window=D;B._document=G;return F},formContents:function(F){var E=[];var D=[];var B=MochiKit.Base;var C=MochiKit.DOM;if(typeof (F)=="undefined"||F===null){F=C._document.body}else{F=C.getElement(F)}B.nodeWalk(F,function(N){var I=N.name;if(B.isNotEmpty(I)){var G=N.tagName.toUpperCase();if(G==="INPUT"&&(N.type=="radio"||N.type=="checkbox")&&!N.checked){return null}if(G==="SELECT"){if(N.type=="select-one"){if(N.selectedIndex>=0){var K=N.options[N.selectedIndex];var H=K.value;if(!H){var L=K.outerHTML;if(L&&!L.match(/^[^>]+\svalue\s*=/i)){H=K.text}}E.push(I);D.push(H);return null}E.push(I);D.push("");return null}else{var M=N.options;if(!M.length){E.push(I);D.push("");return null}for(var J=0;J<M.length;J++){var K=M[J];if(!K.selected){continue}var H=K.value;if(!H){var L=K.outerHTML;if(L&&!L.match(/^[^>]+\svalue\s*=/i)){H=K.text}}E.push(I);D.push(H)}return null}}if(G==="FORM"||G==="P"||G==="SPAN"||G==="DIV"){return N.childNodes}E.push(I);D.push(N.value||"");return null}return N.childNodes});return[E,D]},withDocument:function(G,C){var B=MochiKit.DOM;var D=B._document;var F;try{B._document=G;F=C()}catch(E){B._document=D;throw E}B._document=D;return F},registerDOMConverter:function(D,C,E,B){MochiKit.DOM.domConverters.register(D,C,E,B)},coerceToDOM:function(F,M){var G=MochiKit.Base;var I=MochiKit.Iter;var L=MochiKit.DOM;if(I){var J=I.iter;var K=I.repeat;var D=G.map}var E=L.domConverters;var C=arguments.callee;var B=G.NotFound;while(true){if(typeof (F)=="undefined"||F===null){return null}if(typeof (F)=="function"&&typeof (F.length)=="number"&&!(F instanceof Function)){F=I.list(F)}if(typeof (F.nodeType)!="undefined"&&F.nodeType>0){return F}if(typeof (F)=="number"||typeof (F)=="boolean"){F=F.toString()}if(typeof (F)=="string"){return L._document.createTextNode(F)}if(typeof (F.__dom__)=="function"){F=F.__dom__(M);continue}if(typeof (F.dom)=="function"){F=F.dom(M);continue}if(typeof (F)=="function"){F=F.apply(M,[M]);continue}if(I){var N=null;try{N=J(F)}catch(H){}if(N){return D(C,N,K(M))}}try{F=E.match(F,M);continue}catch(H){if(H!=B){throw H}}return L._document.createTextNode(F.toString())}return undefined},isChildNode:function(E,D){var C=MochiKit.DOM;if(typeof (E)=="string"){E=C.getElement(E)}if(typeof (D)=="string"){D=C.getElement(D)}if(typeof (E)=="undefined"||E===null||E===C._document){return false}do{if(E===D){return true}var B=E.tagName;E=E.parentNode;if(!B){break}B=B.toUpperCase()}while(B!="BODY"&&B!="HTML");return false},setNodeAttribute:function(C,B,F){var E={};E[B]=F;try{return MochiKit.DOM.updateNodeAttributes(C,E)}catch(D){}return null},getNodeAttribute:function(D,B){var C=MochiKit.DOM;var F=C.attributeArray.renames[B];D=C.getElement(D);try{if(F){return D[F]}return D.getAttribute(B)}catch(E){}return null},removeNodeAttribute:function(E,B){var C=MochiKit.DOM;var D=C.attributeArray.renames[B];E=C.getElement(E);try{if(D){return E[D]}return E.removeAttribute(B)}catch(F){}return null},updateNodeAttributes:function(B,H){var C=B;var J=MochiKit.DOM;if(typeof (B)=="string"){C=J.getElement(B)}if(H){var G=MochiKit.Base.updatetree;if(J.attributeArray.compliant){for(var E in H){var I=H[E];if(typeof (I)=="object"&&typeof (C[E])=="object"){if(E=="style"&&MochiKit.Style){MochiKit.Style.setStyle(C,I)}else{G(C[E],I)}}else{if(E.substring(0,2)=="on"){if(typeof (I)=="string"){I=new Function(I)}C[E]=I}else{C.setAttribute(E,I)}}}}else{var F=J.attributeArray.renames;for(var E in H){I=H[E];var D=F[E];if(E=="style"&&typeof (I)=="string"){C.style.cssText=I}else{if(typeof (D)=="string"){C[D]=I}else{if(typeof (C[E])=="object"&&typeof (I)=="object"){if(E=="style"&&MochiKit.Style){MochiKit.Style.setStyle(C,I)}else{G(C[E],I)}}else{if(E.substring(0,2)=="on"){if(typeof (I)=="string"){I=new Function(I)}C[E]=I}else{C.setAttribute(E,I)}}}}}}}return C},appendChildNodes:function(E){var D=E;var C=MochiKit.DOM;if(typeof (E)=="string"){D=C.getElement(E)}var B=[C.coerceToDOM(MochiKit.Base.extend(null,arguments,1),D)];var G=MochiKit.Base.concat;while(B.length){var F=B.shift();if(typeof (F)=="undefined"||F===null){}else{if(typeof (F.nodeType)=="number"){D.appendChild(F)}else{B=G(F,B)}}}return D},insertSiblingNodesBefore:function(F){var E=F;var B=MochiKit.DOM;if(typeof (F)=="string"){E=B.getElement(F)}var G=[B.coerceToDOM(MochiKit.Base.extend(null,arguments,1),E)];var D=E.parentNode;var C=MochiKit.Base.concat;while(G.length){var H=G.shift();if(typeof (H)=="undefined"||H===null){}else{if(typeof (H.nodeType)=="number"){D.insertBefore(H,E)}else{G=C(H,G)}}}return D},insertSiblingNodesAfter:function(E){var D=E;var C=MochiKit.DOM;if(typeof (E)=="string"){D=C.getElement(E)}var B=[C.coerceToDOM(MochiKit.Base.extend(null,arguments,1),D)];if(D.nextSibling){return C.insertSiblingNodesBefore(D.nextSibling,B)}else{return C.appendChildNodes(D.parentNode,B)}},replaceChildNodes:function(E){var D=E;var C=MochiKit.DOM;if(typeof (E)=="string"){D=C.getElement(E);arguments[0]=D}var B;while((B=D.firstChild)){D.removeChild(B)}if(arguments.length<2){return D}else{return C.appendChildNodes.apply(this,arguments)}},createDOM:function(B,I){var C;var J=MochiKit.DOM;var D=MochiKit.Base;if(typeof (I)=="string"||typeof (I)=="number"){var F=D.extend([B,null],arguments,1);return arguments.callee.apply(this,F)}if(typeof (B)=="string"){var H=J._xhtml;if(I&&!J.attributeArray.compliant){var G="";if("name" in I){G+=' name="'+J.escapeHTML(I.name)+'"'}if(B=="input"&&"type" in I){G+=' type="'+J.escapeHTML(I.type)+'"'}if(G){B="<"+B+G+">";H=false}}var E=J._document;if(H&&E===document){C=E.createElementNS("http://www.w3.org/1999/xhtml",B)}else{C=E.createElement(B)}}else{C=B}if(I){J.updateNodeAttributes(C,I)}if(arguments.length<=2){return C}else{var F=D.extend([C],arguments,2);return J.appendChildNodes.apply(this,F)}},createDOMFunc:function(){var B=MochiKit.Base;return B.partial.apply(this,B.extend([MochiKit.DOM.createDOM],arguments))},removeElement:function(B){var C=MochiKit.DOM.getElement(B);C.parentNode.removeChild(C);return C},swapDOM:function(D,E){var B=MochiKit.DOM;D=B.getElement(D);var C=D.parentNode;if(E){E=B.getElement(E);C.replaceChild(E,D)}else{C.removeChild(D)}return E},getElement:function(C){var B=MochiKit.DOM;if(arguments.length==1){return((typeof (C)=="string")?B._document.getElementById(C):C)}else{return MochiKit.Base.map(B.getElement,arguments)}},getElementsByTagAndClassName:function(J,I,H){var L=MochiKit.DOM;if(typeof (J)=="undefined"||J===null){J="*"}if(typeof (H)=="undefined"||H===null){H=L._document}H=L.getElement(H);var F=(H.getElementsByTagName(J)||L._document.all);if(typeof (I)=="undefined"||I===null){return MochiKit.Base.extend(null,F)}var E=[];for(var G=0;G<F.length;G++){var C=F[G];var K=C.className;if(!K){continue}var B=K.split(" ");for(var D=0;D<B.length;D++){if(B[D]==I){E.push(C);break}}}return E},_newCallStack:function(D,B){var C=function(){var F=arguments.callee.callStack;for(var E=0;E<F.length;E++){if(F[E].apply(this,arguments)===false){break}}if(B){try{this[D]=null}catch(G){}}};C.callStack=[];return C},addToCallStack:function(C,F,E,D){var B=MochiKit.DOM;var H=C[F];var G=H;if(!(typeof (H)=="function"&&typeof (H.callStack)=="object"&&H.callStack!==null)){G=B._newCallStack(F,D);if(typeof (H)=="function"){G.callStack.push(H)}C[F]=G}G.callStack.push(E)},addLoadEvent:function(C){var B=MochiKit.DOM;B.addToCallStack(B._window,"onload",C,true)},focusOnLoad:function(C){var B=MochiKit.DOM;B.addLoadEvent(function(){C=B.getElement(C);if(C){C.focus()}})},setElementClass:function(E,D){var B=MochiKit.DOM;var C=B.getElement(E);if(B.attributeArray.compliant){C.setAttribute("class",D)}else{C.setAttribute("className",D)}},toggleElementClass:function(D){var B=MochiKit.DOM;for(var C=1;C<arguments.length;C++){var E=B.getElement(arguments[C]);if(!B.addElementClass(E,D)){B.removeElementClass(E,D)}}},addElementClass:function(E,D){var C=MochiKit.DOM;var G=C.getElement(E);var B=G.className;if(B==undefined||B.length===0){C.setElementClass(G,D);return true}if(B==D){return false}var H=B.split(" ");for(var F=0;F<H.length;F++){if(H[F]==D){return false}}C.setElementClass(G,B+" "+D);return true},removeElementClass:function(G,B){var D=MochiKit.DOM;var H=D.getElement(G);var C=H.className;if(C==undefined||C.length===0){return false}if(C==B){D.setElementClass(H,"");return true}var F=C.split(" ");for(var E=0;E<F.length;E++){if(F[E]==B){F.splice(E,1);D.setElementClass(H,F.join(" "));return true}}return false},swapElementClass:function(E,D,C){var F=MochiKit.DOM.getElement(E);var B=MochiKit.DOM.removeElementClass(F,D);if(B){MochiKit.DOM.addElementClass(F,C)}return B},hasElementClass:function(D,C){var H=MochiKit.DOM.getElement(D);var B=H.className;if(!B){return false}var I=B.split(" ");for(var F=1;F<arguments.length;F++){var G=false;for(var E=0;E<I.length;E++){if(I[E]==arguments[F]){G=true;break}}if(!G){return false}}return true},escapeHTML:function(B){return B.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},toHTML:function(B){return MochiKit.DOM.emitHTML(B).join("")},emitHTML:function(E,G){if(typeof (G)=="undefined"||G===null){G=[]}var C=[E];var L=MochiKit.DOM;var B=L.escapeHTML;var N=L.attributeArray;while(C.length){E=C.pop();if(typeof (E)=="string"){G.push(E)}else{if(E.nodeType==1){G.push("<"+E.tagName.toLowerCase());var K=[];var J=N(E);for(var F=0;F<J.length;F++){var I=J[F];K.push([" ",I.name,'="',B(I.value),'"'])}K.sort();for(F=0;F<K.length;F++){var H=K[F];for(var D=0;D<H.length;D++){G.push(H[D])}}if(E.hasChildNodes()){G.push(">");C.push("</"+E.tagName.toLowerCase()+">");var M=E.childNodes;for(F=M.length-1;F>=0;F--){C.push(M[F])}}else{G.push("/>")}}else{if(E.nodeType==3){G.push(B(E.nodeValue))}}}}return G},scrapeText:function(C,B){var D=[];(function(F){var H=F.childNodes;if(H){for(var E=0;E<H.length;E++){arguments.callee.call(this,H[E])}}var G=F.nodeValue;if(typeof (G)=="string"){D.push(G)}})(MochiKit.DOM.getElement(C));if(B){return D}else{return D.join("")}},removeEmptyTextNodes:function(D){D=MochiKit.DOM.getElement(D);for(var B=0;B<D.childNodes.length;B++){var C=D.childNodes[B];if(C.nodeType==3&&!/\S/.test(C.nodeValue)){C.parentNode.removeChild(C)}}},makeClipping:function(C){C=MochiKit.DOM.getElement(C);var B=C.style.overflow;if((MochiKit.Style.getStyle(C,"overflow")||"visible")!="hidden"){C.style.overflow="hidden"}return B},undoClipping:function(C,B){C=MochiKit.DOM.getElement(C);if(!B){return }C.style.overflow=B},makePositioned:function(B){B=MochiKit.DOM.getElement(B);var C=MochiKit.Style.getStyle(B,"position");if(C=="static"||!C){B.style.position="relative";if(/Opera/.test(navigator.userAgent)){B.style.top=0;B.style.left=0}}},undoPositioned:function(B){B=MochiKit.DOM.getElement(B);if(B.style.position=="relative"){B.style.position=B.style.top=B.style.left=B.style.bottom=B.style.right=""}},getFirstElementByTagAndClassName:function(J,H,G){var I=MochiKit.DOM;if(typeof (J)=="undefined"||J===null){J="*"}if(typeof (G)=="undefined"||G===null){G=I._document}G=I.getElement(G);var F=(G.getElementsByTagName(J)||I._document.all);if(typeof (H)=="undefined"||H===null){return F[0]}for(var C=0;C<F.length;C++){var E=F[C];var D=E.className.split(" ");for(var B=0;B<D.length;B++){if(D[B]==H){return E}}}},getFirstParentByTagAndClassName:function(E,F,D){var B=MochiKit.DOM;E=B.getElement(E);if(typeof (F)=="undefined"||F===null){F="*"}else{F=F.toUpperCase()}if(typeof (D)=="undefined"||D===null){D=null}var H="";var G="";while(E&&E.tagName){E=E.parentNode;if(F=="*"&&D===null){return E}H=E.className.split(" ");G=E.tagName.toUpperCase();if(D===null&&F==G){return E}else{if(D!==null){for(var C=0;C<H.length;C++){if(F=="*"&&H[C]==D){return E}else{if(F==G&&H[C]==D){return E}}}}}}return E},isParent:function(C,B){if(!C.parentNode||C==B){return false}if(C.parentNode==B){return true}return MochiKit.DOM.isParent(C.parentNode,B)},__new__:function(L){var D=MochiKit.Base;if(typeof (document)!="undefined"){this._document=document;var K="http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul";this._xhtml=(document.documentElement&&document.createElementNS&&document.documentElement.namespaceURI===K)}else{if(MochiKit.MockDOM){this._document=MochiKit.MockDOM.document}}this._window=L;this.domConverters=new D.AdapterRegistry();var J=this._document.createElement("span");var I;if(J&&J.attributes&&J.attributes.length>0){var G=D.filter;I=function(N){return G(I.ignoreAttrFilter,N.attributes)};I.ignoreAttr={};var E=J.attributes;var C=I.ignoreAttr;for(var H=0;H<E.length;H++){var M=E[H];C[M.name]=M.value}I.ignoreAttrFilter=function(N){return(I.ignoreAttr[N.name]!=N.value)};I.compliant=false;I.renames={"class":"className",checked:"defaultChecked",usemap:"useMap","for":"htmlFor",readonly:"readOnly",colspan:"colSpan",bgcolor:"bgColor",cellspacing:"cellSpacing",cellpadding:"cellPadding"}}else{I=function(N){return N.attributes};I.compliant=true;I.renames={}}this.attributeArray=I;var F=function(Q,N){var O=N[1].split(".");var R="";var P={};R+="if (!MochiKit."+O[1]+') { throw new Error("';R+="This function has been deprecated and depends on MochiKit.";R+=O[1]+'.");}';R+="return MochiKit."+O[1]+"."+N[0];R+=".apply(this, arguments);";P[O[2]]=new Function(R);MochiKit.Base.update(MochiKit[Q],P)};for(var H;H<MochiKit.DOM.DEPRECATED.length;H++){F("DOM",MochiKit.DOM.DEPRECATED[H])}var B=this.createDOMFunc;this.UL=B("ul");this.OL=B("ol");this.LI=B("li");this.TD=B("td");this.TR=B("tr");this.TBODY=B("tbody");this.THEAD=B("thead");this.TFOOT=B("tfoot");this.TABLE=B("table");this.TH=B("th");this.INPUT=B("input");this.SPAN=B("span");this.A=B("a");this.DIV=B("div");this.IMG=B("img");this.BUTTON=B("button");this.TT=B("tt");this.PRE=B("pre");this.H1=B("h1");this.H2=B("h2");this.H3=B("h3");this.BR=B("br");this.HR=B("hr");this.LABEL=B("label");this.TEXTAREA=B("textarea");this.FORM=B("form");this.P=B("p");this.SELECT=B("select");this.OPTION=B("option");this.OPTGROUP=B("optgroup");this.LEGEND=B("legend");this.FIELDSET=B("fieldset");this.STRONG=B("strong");this.CANVAS=B("canvas");this.$=this.getElement;this.EXPORT_TAGS={":common":this.EXPORT,":all":D.concat(this.EXPORT,this.EXPORT_OK)};D.nameFunctions(this)}});MochiKit.DOM.__new__(((typeof (window)=="undefined")?this:window));if(MochiKit.__export__){withWindow=MochiKit.DOM.withWindow;withDocument=MochiKit.DOM.withDocument}MochiKit.Base._exportSymbols(this,MochiKit.DOM);if(typeof (dojo)!="undefined"){dojo.provide("MochiKit.Style");dojo.require("MochiKit.Base");dojo.require("MochiKit.DOM")}if(typeof (JSAN)!="undefined"){JSAN.use("MochiKit.Base",[]);JSAN.use("MochiKit.DOM",[])}try{if(typeof (MochiKit.Base)=="undefined"){throw""}}catch(e){throw"MochiKit.Style depends on MochiKit.Base!"}try{if(typeof (MochiKit.DOM)=="undefined"){throw""}}catch(e){throw"MochiKit.Style depends on MochiKit.DOM!"}if(typeof (MochiKit.Style)=="undefined"){MochiKit.Style={}}MochiKit.Style.NAME="MochiKit.Style";MochiKit.Style.VERSION="1.4";MochiKit.Style.__repr__=function(){return"["+this.NAME+" "+this.VERSION+"]"};MochiKit.Style.toString=function(){return this.__repr__()};MochiKit.Style.EXPORT_OK=[];MochiKit.Style.EXPORT=["setStyle","setOpacity","getStyle","getElementDimensions","elementDimensions","setElementDimensions","getElementPosition","elementPosition","setElementPosition","setDisplayForElement","hideElement","showElement","getViewportDimensions","getViewportPosition","Dimensions","Coordinates"];MochiKit.Style.Dimensions=function(B,C){this.w=B;this.h=C};MochiKit.Style.Dimensions.prototype.__repr__=function(){var B=MochiKit.Base.repr;return"{w: "+B(this.w)+", h: "+B(this.h)+"}"};MochiKit.Style.Dimensions.prototype.toString=function(){return this.__repr__()};MochiKit.Style.Coordinates=function(B,C){this.x=B;this.y=C};MochiKit.Style.Coordinates.prototype.__repr__=function(){var B=MochiKit.Base.repr;return"{x: "+B(this.x)+", y: "+B(this.y)+"}"};MochiKit.Style.Coordinates.prototype.toString=function(){return this.__repr__()};MochiKit.Base.update(MochiKit.Style,{getStyle:function(D,B){var G=MochiKit.DOM;var F=G._document;D=G.getElement(D);B=MochiKit.Base.camelize(B);if(!D||D==F){return undefined}if(B=="opacity"&&D.filters){var H=(MochiKit.Style.getStyle(D,"filter")||"").match(/alpha\(opacity=(.*)\)/);if(H&&H[1]){return parseFloat(H[1])/100}return 1}var E=D.style?D.style[B]:null;if(!E){if(F.defaultView&&F.defaultView.getComputedStyle){var C=F.defaultView.getComputedStyle(D,null);B=B.replace(/([A-Z])/g,"-$1").toLowerCase();E=C?C.getPropertyValue(B):null}else{if(D.currentStyle){E=D.currentStyle[B]}}}if(B=="opacity"){E=parseFloat(E)}if(/Opera/.test(navigator.userAgent)&&(MochiKit.Base.find(["left","top","right","bottom"],B)!=-1)){if(MochiKit.Style.getStyle(D,"position")=="static"){E="auto"}}return E=="auto"?null:E},setStyle:function(C,D){C=MochiKit.DOM.getElement(C);for(var B in D){if(B=="opacity"){MochiKit.Style.setOpacity(C,D[B])}else{C.style[MochiKit.Base.camelize(B)]=D[B]}}},setOpacity:function(D,E){D=MochiKit.DOM.getElement(D);var B=MochiKit.Style;if(E==1){var C=/Gecko/.test(navigator.userAgent)&&!(/Konqueror|AppleWebKit|KHTML/.test(navigator.userAgent));D.style.opacity=C?0.999999:1;if(/MSIE/.test(navigator.userAgent)){D.style.filter=B.getStyle(D,"filter").replace(/alpha\([^\)]*\)/gi,"")}}else{if(E<0.00001){E=0}D.style.opacity=E;if(/MSIE/.test(navigator.userAgent)){D.style.filter=B.getStyle(D,"filter").replace(/alpha\([^\)]*\)/gi,"")+"alpha(opacity="+E*100+")"}}},getElementPosition:function(C,G){var N=MochiKit.Style;var D=MochiKit.DOM;C=D.getElement(C);if(!C||(!(C.x&&C.y)&&(!C.parentNode===null||N.getStyle(C,"display")=="none"))){return undefined}var J=new N.Coordinates(0,0);var F=null;var H=null;var I=MochiKit.DOM._document;var L=I.documentElement;var K=I.body;if(!C.parentNode&&C.x&&C.y){J.x+=C.x||0;J.y+=C.y||0}else{if(C.getBoundingClientRect){F=C.getBoundingClientRect();J.x+=F.left+(L.scrollLeft||K.scrollLeft)-(L.clientLeft||0);J.y+=F.top+(L.scrollTop||K.scrollTop)-(L.clientTop||0)}else{if(C.offsetParent){J.x+=C.offsetLeft;J.y+=C.offsetTop;H=C.offsetParent;if(H!=C){while(H){J.x+=H.offsetLeft;J.y+=H.offsetTop;H=H.offsetParent}}var B=navigator.userAgent.toLowerCase();if((typeof (opera)!="undefined"&&parseFloat(opera.version())<9)||(B.indexOf("AppleWebKit")!=-1&&N.getStyle(C,"position")=="absolute")){J.x-=K.offsetLeft;J.y-=K.offsetTop}}}}if(typeof (G)!="undefined"){G=arguments.callee(G);if(G){J.x-=(G.x||0);J.y-=(G.y||0)}}if(C.parentNode){H=C.parentNode}else{H=null}while(H){var E=H.tagName.toUpperCase();if(E==="BODY"||E==="HTML"){break}var M=N.getStyle(H,"display");if(M!="inline"&&M!="table-row"){J.x-=H.scrollLeft;J.y-=H.scrollTop}if(H.parentNode){H=H.parentNode}else{H=null}}return J},setElementPosition:function(F,E,D){F=MochiKit.DOM.getElement(F);if(typeof (D)=="undefined"){D="px"}var C={};var B=MochiKit.Base.isUndefinedOrNull;if(!B(E.x)){C.left=E.x+D}if(!B(E.y)){C.top=E.y+D}MochiKit.DOM.updateNodeAttributes(F,{style:C})},getElementDimensions:function(D){var I=MochiKit.Style;var E=MochiKit.DOM;if(typeof (D.w)=="number"||typeof (D.h)=="number"){return new I.Dimensions(D.w||0,D.h||0)}D=E.getElement(D);if(!D){return undefined}var H=I.getStyle(D,"display");if(H!="none"&&H!==""&&typeof (H)!="undefined"){return new I.Dimensions(D.offsetWidth||0,D.offsetHeight||0)}var J=D.style;var C=J.visibility;var B=J.position;J.visibility="hidden";J.position="absolute";J.display="";var G=D.offsetWidth;var F=D.offsetHeight;J.display="none";J.position=B;J.visibility=C;return new I.Dimensions(G,F)},setElementDimensions:function(F,E,D){F=MochiKit.DOM.getElement(F);if(typeof (D)=="undefined"){D="px"}var C={};var B=MochiKit.Base.isUndefinedOrNull;if(!B(E.w)){C.width=E.w+D}if(!B(E.h)){C.height=E.h+D}MochiKit.DOM.updateNodeAttributes(F,{style:C})},setDisplayForElement:function(D,C){var B=MochiKit.Base.extend(null,arguments,1);var F=MochiKit.DOM.getElement;for(var E=0;E<B.length;E++){C=F(B[E]);if(C){C.style.display=D}}},getViewportDimensions:function(){var D=new MochiKit.Style.Dimensions();var C=MochiKit.DOM._window;var B=MochiKit.DOM._document.body;if(C.innerWidth){D.w=C.innerWidth;D.h=C.innerHeight}else{if(B.parentElement.clientWidth){D.w=B.parentElement.clientWidth;D.h=B.parentElement.clientHeight}else{if(B&&B.clientWidth){D.w=B.clientWidth;D.h=B.clientHeight}}}return D},getViewportPosition:function(){var E=new MochiKit.Style.Coordinates(0,0);var C=MochiKit.DOM._document;var D=C.documentElement;var B=C.body;if(D&&(D.scrollTop||D.scrollLeft)){E.x=D.scrollLeft;E.y=D.scrollTop}else{if(B){E.x=B.scrollLeft;E.y=B.scrollTop}}return E},__new__:function(){var B=MochiKit.Base;this.elementPosition=this.getElementPosition;this.elementDimensions=this.getElementDimensions;this.hideElement=B.partial(this.setDisplayForElement,"none");this.showElement=B.partial(this.setDisplayForElement,"block");this.EXPORT_TAGS={":common":this.EXPORT,":all":B.concat(this.EXPORT,this.EXPORT_OK)};B.nameFunctions(this)}});MochiKit.Style.__new__();MochiKit.Base._exportSymbols(this,MochiKit.Style);if(typeof (dojo)!="undefined"){dojo.provide("MochiKit.Color");dojo.require("MochiKit.Base");dojo.require("MochiKit.DOM");dojo.require("MochiKit.Style")}if(typeof (JSAN)!="undefined"){JSAN.use("MochiKit.Base",[]);JSAN.use("MochiKit.DOM",[]);JSAN.use("MochiKit.Style",[])}try{if(typeof (MochiKit.Base)=="undefined"){throw""}}catch(e){throw"MochiKit.Color depends on MochiKit.Base"}try{if(typeof (MochiKit.DOM)=="undefined"){throw""}}catch(e){throw"MochiKit.Color depends on MochiKit.DOM"}try{if(typeof (MochiKit.Style)=="undefined"){throw""}}catch(e){throw"MochiKit.Color depends on MochiKit.Style"}if(typeof (MochiKit.Color)=="undefined"){MochiKit.Color={}}MochiKit.Color.NAME="MochiKit.Color";MochiKit.Color.VERSION="1.4";MochiKit.Color.__repr__=function(){return"["+this.NAME+" "+this.VERSION+"]"};MochiKit.Color.toString=function(){return this.__repr__()};MochiKit.Color.Color=function(E,D,B,C){if(typeof (C)=="undefined"||C===null){C=1}this.rgb={r:E,g:D,b:B,a:C}};MochiKit.Color.Color.prototype={__class__:MochiKit.Color.Color,colorWithAlpha:function(D){var C=this.rgb;var B=MochiKit.Color;return B.Color.fromRGB(C.r,C.g,C.b,D)},colorWithHue:function(D){var C=this.asHSL();C.h=D;var B=MochiKit.Color;return B.Color.fromHSL(C)},colorWithSaturation:function(D){var C=this.asHSL();C.s=D;var B=MochiKit.Color;return B.Color.fromHSL(C)},colorWithLightness:function(C){var D=this.asHSL();D.l=C;var B=MochiKit.Color;return B.Color.fromHSL(D)},darkerColorWithLevel:function(D){var C=this.asHSL();C.l=Math.max(C.l-D,0);var B=MochiKit.Color;return B.Color.fromHSL(C)},lighterColorWithLevel:function(D){var C=this.asHSL();C.l=Math.min(C.l+D,1);var B=MochiKit.Color;return B.Color.fromHSL(C)},blendedColor:function(E,D){if(typeof (D)=="undefined"||D===null){D=0.5}var C=1-D;var B=this.rgb;var G=E.rgb;var F=D;return MochiKit.Color.Color.fromRGB((B.r*C)+(G.r*F),(B.g*C)+(G.g*F),(B.b*C)+(G.b*F),(B.a*C)+(G.a*F))},compareRGB:function(D){var C=this.asRGB();var B=D.asRGB();return MochiKit.Base.compare([C.r,C.g,C.b,C.a],[B.r,B.g,B.b,B.a])},isLight:function(){return this.asHSL().b>0.5},isDark:function(){return(!this.isLight())},toHSLString:function(){var F=this.asHSL();var E=MochiKit.Color.clampColorComponent;var D=this._hslString;if(!D){var C=(E(F.h,360).toFixed(0)+","+E(F.s,100).toPrecision(4)+"%,"+E(F.l,100).toPrecision(4)+"%");var B=F.a;if(B>=1){B=1;D="hsl("+C+")"}else{if(B<=0){B=0}D="hsla("+C+","+B+")"}this._hslString=D}return D},toRGBString:function(){var E=this.rgb;var D=MochiKit.Color.clampColorComponent;var C=this._rgbString;if(!C){var B=(D(E.r,255).toFixed(0)+","+D(E.g,255).toFixed(0)+","+D(E.b,255).toFixed(0));if(E.a!=1){C="rgba("+B+","+E.a+")"}else{C="rgb("+B+")"}this._rgbString=C}return C},asRGB:function(){return MochiKit.Base.clone(this.rgb)},toHexString:function(){var B=MochiKit.Color;var E=this.rgb;var D=MochiKit.Color.clampColorComponent;var C=this._hexString;if(!C){C=("#"+B.toColorPart(D(E.r,255))+B.toColorPart(D(E.g,255))+B.toColorPart(D(E.b,255)));this._hexString=C}return C},asHSV:function(){var B=this.hsv;var C=this.rgb;if(typeof (B)=="undefined"||B===null){B=MochiKit.Color.rgbToHSV(this.rgb);this.hsv=B}return MochiKit.Base.clone(B)},asHSL:function(){var B=this.hsl;var C=this.rgb;if(typeof (B)=="undefined"||B===null){B=MochiKit.Color.rgbToHSL(this.rgb);this.hsl=B}return MochiKit.Base.clone(B)},toString:function(){return this.toRGBString()},repr:function(){var C=this.rgb;var B=[C.r,C.g,C.b,C.a];return this.__class__.NAME+"("+B.join(", ")+")"}};MochiKit.Base.update(MochiKit.Color.Color,{fromRGB:function(F,G,B,E){var C=MochiKit.Color.Color;if(arguments.length==1){var D=F;F=D.r;G=D.g;B=D.b;if(typeof (D.a)=="undefined"){E=undefined}else{E=D.a}}return new C(F,G,B,E)},fromHSL:function(C,F,E,D){var B=MochiKit.Color;return B.Color.fromRGB(B.hslToRGB.apply(B,arguments))},fromHSV:function(C,F,E,D){var B=MochiKit.Color;return B.Color.fromRGB(B.hsvToRGB.apply(B,arguments))},fromName:function(D){var C=MochiKit.Color.Color;if(D.charAt(0)=='"'){D=D.substr(1,D.length-2)}var B=C._namedColors[D.toLowerCase()];if(typeof (B)=="string"){return C.fromHexString(B)}else{if(D=="transparent"){return C.transparentColor()}}return null},fromString:function(D){var C=MochiKit.Color.Color;var B=D.substr(0,3);if(B=="rgb"){return C.fromRGBString(D)}else{if(B=="hsl"){return C.fromHSLString(D)}else{if(D.charAt(0)=="#"){return C.fromHexString(D)}}}return C.fromName(D)},fromHexString:function(C){if(C.charAt(0)=="#"){C=C.substring(1)}var B=[];var D,E;if(C.length==3){for(D=0;D<3;D++){E=C.substr(D,1);B.push(parseInt(E+E,16)/255)}}else{for(D=0;D<6;D+=2){E=C.substr(D,2);B.push(parseInt(E,16)/255)}}var F=MochiKit.Color.Color;return F.fromRGB.apply(F,B)},_fromColorString:function(G,I,H,E){if(E.indexOf(G)===0){E=E.substring(E.indexOf("(",3)+1,E.length-1)}var D=E.split(/\s*,\s*/);var B=[];for(var J=0;J<D.length;J++){var K=D[J];var C;var F=K.substring(K.length-3);if(K.charAt(K.length-1)=="%"){C=0.01*parseFloat(K.substring(0,K.length-1))}else{if(F=="deg"){C=parseFloat(K)/360}else{if(F=="rad"){C=parseFloat(K)/(Math.PI*2)}else{C=H[J]*parseFloat(K)}}}B.push(C)}return this[I].apply(this,B)},fromComputedStyle:function(F,E){var G=MochiKit.DOM;var D=MochiKit.Color.Color;for(F=G.getElement(F);F;F=F.parentNode){var B=MochiKit.Style.getStyle.apply(G,arguments);if(!B){continue}var C=D.fromString(B);if(!C){break}if(C.asRGB().a>0){return C}}return null},fromBackground:function(C){var B=MochiKit.Color.Color;return B.fromComputedStyle(C,"backgroundColor","background-color")||B.whiteColor()},fromText:function(C){var B=MochiKit.Color.Color;return B.fromComputedStyle(C,"color","color")||B.blackColor()},namedColors:function(){return MochiKit.Base.clone(MochiKit.Color.Color._namedColors)}});MochiKit.Base.update(MochiKit.Color,{clampColorComponent:function(B,C){B*=C;if(B<0){return 0}else{if(B>C){return C}else{return B}}},_hslValue:function(D,C,B){if(B>6){B-=6}else{if(B<0){B+=6}}var E;if(B<1){E=D+(C-D)*B}else{if(B<3){E=C}else{if(B<4){E=D+(C-D)*(4-B)}else{E=D}}}return E},hsvToRGB:function(G,M,K,J){if(arguments.length==1){var F=G;G=F.h;M=F.s;K=F.v;J=F.a}var D;var I;var L;if(M===0){D=K;I=K;L=K}else{var E=Math.floor(G*6);var H=(G*6)-E;var C=K*(1-M);var B=K*(1-(M*H));var N=K*(1-(M*(1-H)));switch(E){case 1:D=B;I=K;L=C;break;case 2:D=C;I=K;L=N;break;case 3:D=C;I=B;L=K;break;case 4:D=N;I=C;L=K;break;case 5:D=K;I=C;L=B;break;case 6:case 0:D=K;I=N;L=C;break}}return{r:D,g:I,b:L,a:J}},hslToRGB:function(F,C,I,H){if(arguments.length==1){var L=F;F=L.h;C=L.s;I=L.l;H=L.a}var B;var D;var J;if(C===0){B=I;D=I;J=I}else{var K;if(I<=0.5){K=I*(1+C)}else{K=I+C-(I*C)}var M=(2*I)-K;var G=MochiKit.Color._hslValue;var E=F*6;B=G(M,K,E+2);D=G(M,K,E);J=G(M,K,E-2)}return{r:B,g:D,b:J,a:H}},rgbToHSV:function(G,F,L,C){if(arguments.length==1){var J=G;G=J.r;F=J.g;L=J.b;C=J.a}var K=Math.max(Math.max(G,F),L);var H=Math.min(Math.min(G,F),L);var I;var E;var D=K;if(H==K){I=0;E=0}else{var B=(K-H);E=B/K;if(G==K){I=(F-L)/B}else{if(F==K){I=2+((L-G)/B)}else{I=4+((G-F)/B)}}I/=6;if(I<0){I+=1}if(I>1){I-=1}}return{h:I,s:E,v:D,a:C}},rgbToHSL:function(E,H,L,F){if(arguments.length==1){var J=E;E=J.r;H=J.g;L=J.b;F=J.a}var K=Math.max(E,Math.max(H,L));var G=Math.min(E,Math.min(H,L));var I;var D;var C=(K+G)/2;var B=K-G;if(B===0){I=0;D=0}else{if(C<=0.5){D=B/(K+G)}else{D=B/(2-K-G)}if(E==K){I=(H-L)/B}else{if(H==K){I=2+((L-E)/B)}else{I=4+((E-H)/B)}}I/=6;if(I<0){I+=1}if(I>1){I-=1}}return{h:I,s:D,l:C,a:F}},toColorPart:function(C){C=Math.round(C);var B=C.toString(16);if(C<16){return"0"+B}return B},__new__:function(){var F=MochiKit.Base;this.Color.fromRGBString=F.bind(this.Color._fromColorString,this.Color,"rgb","fromRGB",[1/255,1/255,1/255,1]);this.Color.fromHSLString=F.bind(this.Color._fromColorString,this.Color,"hsl","fromHSL",[1/360,0.01,0.01,1]);var E=1/3;var D={black:[0,0,0],blue:[0,0,1],brown:[0.6,0.4,0.2],cyan:[0,1,1],darkGray:[E,E,E],gray:[0.5,0.5,0.5],green:[0,1,0],lightGray:[2*E,2*E,2*E],magenta:[1,0,1],orange:[1,0.5,0],purple:[0.5,0,0.5],red:[1,0,0],transparent:[0,0,0,0],white:[1,1,1],yellow:[1,1,0]};var C=function(M,O,N,K,L){var P=this.fromRGB(O,N,K,L);this[M]=function(){return P};return P};for(var G in D){var B=G+"Color";var I=F.concat([C,this.Color,B],D[G]);this.Color[B]=F.bind.apply(null,I)}var H=function(){for(var K=0;K<arguments.length;K++){if(!(arguments[K] instanceof Color)){return false}}return true};var J=function(L,K){return L.compareRGB(K)};F.nameFunctions(this);F.registerComparator(this.Color.NAME,H,J);this.EXPORT_TAGS={":common":this.EXPORT,":all":F.concat(this.EXPORT,this.EXPORT_OK)}}});MochiKit.Color.EXPORT=["Color"];MochiKit.Color.EXPORT_OK=["clampColorComponent","rgbToHSL","hslToRGB","rgbToHSV","hsvToRGB","toColorPart"];MochiKit.Color.__new__();MochiKit.Base._exportSymbols(this,MochiKit.Color);MochiKit.Color.Color._namedColors={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};if(typeof (dojo)!="undefined"){dojo.provide("MochiKit.Position");dojo.require("MochiKit.Base");dojo.require("MochiKit.DOM");dojo.require("MochiKit.Style")}if(typeof (JSAN)!="undefined"){JSAN.use("MochiKit.Base",[]);JSAN.use("MochiKit.DOM",[]);JSAN.use("MochiKit.Style",[])}try{if(typeof (MochiKit.Base)=="undefined"||typeof (MochiKit.Style)=="undefined"||typeof (MochiKit.DOM)=="undefined"){throw""}}catch(e){throw"MochiKit.Style depends on MochiKit.Base, MochiKit.DOM, and MochiKit.Style!"}if(typeof (MochiKit.Position)=="undefined"){MochiKit.Position={}}MochiKit.Position.NAME="MochiKit.Position";MochiKit.Position.VERSION="1.4";MochiKit.Position.__repr__=function(){return"["+this.NAME+" "+this.VERSION+"]"};MochiKit.Position.toString=function(){return this.__repr__()};MochiKit.Position.EXPORT_OK=[];MochiKit.Position.EXPORT=[];MochiKit.Base.update(MochiKit.Position,{includeScrollOffsets:false,prepare:function(){var C=window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft||0;var B=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0;this.windowOffset=new MochiKit.Style.Coordinates(C,B)},cumulativeOffset:function(C){var B=0;var D=0;do{B+=C.offsetTop||0;D+=C.offsetLeft||0;C=C.offsetParent}while(C);return new MochiKit.Style.Coordinates(D,B)},realOffset:function(D){var C=0;var B=0;do{C+=D.scrollTop||0;B+=D.scrollLeft||0;D=D.parentNode}while(D);return new MochiKit.Style.Coordinates(B,C)},within:function(C,B,D){if(this.includeScrollOffsets){return this.withinIncludingScrolloffsets(C,B,D)}this.xcomp=B;this.ycomp=D;this.offset=this.cumulativeOffset(C);if(C.style.position=="fixed"){this.offset.x+=this.windowOffset.x;this.offset.y+=this.windowOffset.y}return(D>=this.offset.y&&D<this.offset.y+C.offsetHeight&&B>=this.offset.x&&B<this.offset.x+C.offsetWidth)},withinIncludingScrolloffsets:function(C,B,E){var D=this.realOffset(C);this.xcomp=B+D.x-this.windowOffset.x;this.ycomp=E+D.y-this.windowOffset.y;this.offset=this.cumulativeOffset(C);return(this.ycomp>=this.offset.y&&this.ycomp<this.offset.y+C.offsetHeight&&this.xcomp>=this.offset.x&&this.xcomp<this.offset.x+C.offsetWidth)},overlap:function(C,B){if(!C){return 0}if(C=="vertical"){return((this.offset.y+B.offsetHeight)-this.ycomp)/B.offsetHeight}if(C=="horizontal"){return((this.offset.x+B.offsetWidth)-this.xcomp)/B.offsetWidth}},absolutize:function(E){E=MochiKit.DOM.getElement(E);if(E.style.position=="absolute"){return }MochiKit.Position.prepare();var F=MochiKit.Position.positionedOffset(E);var D=E.clientWidth;var C=E.clientHeight;var B={position:E.style.position,left:F.x-parseFloat(E.style.left||0),top:F.y-parseFloat(E.style.top||0),width:E.style.width,height:E.style.height};E.style.position="absolute";E.style.top=F.y+"px";E.style.left=F.x+"px";E.style.width=D+"px";E.style.height=C+"px";return B},positionedOffset:function(D){var C=0,B=0;do{C+=D.offsetTop||0;B+=D.offsetLeft||0;D=D.offsetParent;if(D){p=MochiKit.Style.getStyle(D,"position");if(p=="relative"||p=="absolute"){break}}}while(D);return new MochiKit.Style.Coordinates(B,C)},relativize:function(C,B){C=MochiKit.DOM.getElement(C);if(C.style.position=="relative"){return }MochiKit.Position.prepare();var E=parseFloat(C.style.top||0)-(B.top||0);var D=parseFloat(C.style.left||0)-(B.left||0);C.style.position=B.position;C.style.top=E+"px";C.style.left=D+"px";C.style.width=B.width;C.style.height=B.height},clone:function(D,C){D=MochiKit.DOM.getElement(D);C=MochiKit.DOM.getElement(C);C.style.position="absolute";var B=this.cumulativeOffset(D);C.style.top=B.y+"px";C.style.left=B.x+"px";C.style.width=D.offsetWidth+"px";C.style.height=D.offsetHeight+"px"},page:function(E){var C=0;var D=0;var B=E;do{C+=B.offsetTop||0;D+=B.offsetLeft||0;if(B.offsetParent==document.body&&MochiKit.Style.getStyle(B,"position")=="absolute"){break}}while(B=B.offsetParent);B=E;do{C-=B.scrollTop||0;D-=B.scrollLeft||0}while(B=B.parentNode);return new MochiKit.Style.Coordinates(D,C)}});MochiKit.Position.__new__=function(C){var B=MochiKit.Base;this.EXPORT_TAGS={":common":this.EXPORT,":all":B.concat(this.EXPORT,this.EXPORT_OK)};B.nameFunctions(this)};MochiKit.Position.__new__(this);if(typeof (dojo)!="undefined"){dojo.provide("MochiKit.Signal");dojo.require("MochiKit.Base");dojo.require("MochiKit.DOM");dojo.require("MochiKit.Style")}if(typeof (JSAN)!="undefined"){JSAN.use("MochiKit.Base",[]);JSAN.use("MochiKit.DOM",[]);JSAN.use("MochiKit.Style",[])}try{if(typeof (MochiKit.Base)=="undefined"){throw""}}catch(e){throw"MochiKit.Signal depends on MochiKit.Base!"}try{if(typeof (MochiKit.DOM)=="undefined"){throw""}}catch(e){throw"MochiKit.Signal depends on MochiKit.DOM!"}try{if(typeof (MochiKit.Style)=="undefined"){throw""}}catch(e){throw"MochiKit.Signal depends on MochiKit.Style!"}if(typeof (MochiKit.Signal)=="undefined"){MochiKit.Signal={}}MochiKit.Signal.NAME="MochiKit.Signal";MochiKit.Signal.VERSION="1.4";MochiKit.Signal._observers=[];MochiKit.Signal.Event=function(C,B){this._event=B||window.event;this._src=C};MochiKit.Base.update(MochiKit.Signal.Event.prototype,{__repr__:function(){var B=MochiKit.Base.repr;var C="{event(): "+B(this.event())+", src(): "+B(this.src())+", type(): "+B(this.type())+", target(): "+B(this.target());if(this.type()&&this.type().indexOf("key")===0||this.type().indexOf("mouse")===0||this.type().indexOf("click")!=-1||this.type()=="contextmenu"){C+=", modifier(): {alt: "+B(this.modifier().alt)+", ctrl: "+B(this.modifier().ctrl)+", meta: "+B(this.modifier().meta)+", shift: "+B(this.modifier().shift)+", any: "+B(this.modifier().any)+"}"}if(this.type()&&this.type().indexOf("key")===0){C+=", key(): {code: "+B(this.key().code)+", string: "+B(this.key().string)+"}"}if(this.type()&&(this.type().indexOf("mouse")===0||this.type().indexOf("click")!=-1||this.type()=="contextmenu")){C+=", mouse(): {page: "+B(this.mouse().page)+", client: "+B(this.mouse().client);if(this.type()!="mousemove"){C+=", button: {left: "+B(this.mouse().button.left)+", middle: "+B(this.mouse().button.middle)+", right: "+B(this.mouse().button.right)+"}}"}else{C+="}"}}if(this.type()=="mouseover"||this.type()=="mouseout"){C+=", relatedTarget(): "+B(this.relatedTarget())}C+="}";return C},toString:function(){return this.__repr__()},src:function(){return this._src},event:function(){return this._event},type:function(){return this._event.type||undefined},target:function(){return this._event.target||this._event.srcElement},_relatedTarget:null,relatedTarget:function(){if(this._relatedTarget!==null){return this._relatedTarget}var B=null;if(this.type()=="mouseover"){B=(this._event.relatedTarget||this._event.fromElement)}else{if(this.type()=="mouseout"){B=(this._event.relatedTarget||this._event.toElement)}}if(B!==null){this._relatedTarget=B;return B}return undefined},_modifier:null,modifier:function(){if(this._modifier!==null){return this._modifier}var B={};B.alt=this._event.altKey;B.ctrl=this._event.ctrlKey;B.meta=this._event.metaKey||false;B.shift=this._event.shiftKey;B.any=B.alt||B.ctrl||B.shift||B.meta;this._modifier=B;return B},_key:null,key:function(){if(this._key!==null){return this._key}var B={};if(this.type()&&this.type().indexOf("key")===0){if(this.type()=="keydown"||this.type()=="keyup"){B.code=this._event.keyCode;B.string=(MochiKit.Signal._specialKeys[B.code]||"KEY_UNKNOWN");this._key=B;return B}else{if(this.type()=="keypress"){B.code=0;B.string="";if(typeof (this._event.charCode)!="undefined"&&this._event.charCode!==0&&!MochiKit.Signal._specialMacKeys[this._event.charCode]){B.code=this._event.charCode;B.string=String.fromCharCode(B.code)}else{if(this._event.keyCode&&typeof (this._event.charCode)=="undefined"){B.code=this._event.keyCode;B.string=String.fromCharCode(B.code)}}this._key=B;return B}}}return undefined},_mouse:null,mouse:function(){if(this._mouse!==null){return this._mouse}var C={};var D=this._event;if(this.type()&&(this.type().indexOf("mouse")===0||this.type().indexOf("click")!=-1||this.type()=="contextmenu")){C.client=new MochiKit.Style.Coordinates(0,0);if(D.clientX||D.clientY){C.client.x=(!D.clientX||D.clientX<0)?0:D.clientX;C.client.y=(!D.clientY||D.clientY<0)?0:D.clientY}C.page=new MochiKit.Style.Coordinates(0,0);if(D.pageX||D.pageY){C.page.x=(!D.pageX||D.pageX<0)?0:D.pageX;C.page.y=(!D.pageY||D.pageY<0)?0:D.pageY}else{var E=MochiKit.DOM._document.documentElement;var B=MochiKit.DOM._document.body;C.page.x=D.clientX+(E.scrollLeft||B.scrollLeft)-(E.clientLeft||0);C.page.y=D.clientY+(E.scrollTop||B.scrollTop)-(E.clientTop||0)}if(this.type()!="mousemove"){C.button={};C.button.left=false;C.button.right=false;C.button.middle=false;if(D.which){C.button.left=(D.which==1);C.button.middle=(D.which==2);C.button.right=(D.which==3)}else{C.button.left=!!(D.button&1);C.button.right=!!(D.button&2);C.button.middle=!!(D.button&4)}}this._mouse=C;return C}return undefined},stop:function(){this.stopPropagation();this.preventDefault()},stopPropagation:function(){if(this._event.stopPropagation){this._event.stopPropagation()}else{this._event.cancelBubble=true}},preventDefault:function(){if(this._event.preventDefault){this._event.preventDefault()}else{if(this._confirmUnload===null){this._event.returnValue=false}}},_confirmUnload:null,confirmUnload:function(B){if(this.type()=="beforeunload"){this._confirmUnload=B;this._event.returnValue=B}}});MochiKit.Signal._specialMacKeys={3:"KEY_ENTER",63289:"KEY_NUM_PAD_CLEAR",63276:"KEY_PAGE_UP",63277:"KEY_PAGE_DOWN",63275:"KEY_END",63273:"KEY_HOME",63234:"KEY_ARROW_LEFT",63232:"KEY_ARROW_UP",63235:"KEY_ARROW_RIGHT",63233:"KEY_ARROW_DOWN",63302:"KEY_INSERT",63272:"KEY_DELETE"};(function(){var B=MochiKit.Signal._specialMacKeys;for(i=63236;i<=63242;i++){B[i]="KEY_F"+(i-63236+1)}})();MochiKit.Signal._specialKeys={8:"KEY_BACKSPACE",9:"KEY_TAB",12:"KEY_NUM_PAD_CLEAR",13:"KEY_ENTER",16:"KEY_SHIFT",17:"KEY_CTRL",18:"KEY_ALT",19:"KEY_PAUSE",20:"KEY_CAPS_LOCK",27:"KEY_ESCAPE",32:"KEY_SPACEBAR",33:"KEY_PAGE_UP",34:"KEY_PAGE_DOWN",35:"KEY_END",36:"KEY_HOME",37:"KEY_ARROW_LEFT",38:"KEY_ARROW_UP",39:"KEY_ARROW_RIGHT",40:"KEY_ARROW_DOWN",44:"KEY_PRINT_SCREEN",45:"KEY_INSERT",46:"KEY_DELETE",59:"KEY_SEMICOLON",91:"KEY_WINDOWS_LEFT",92:"KEY_WINDOWS_RIGHT",93:"KEY_SELECT",106:"KEY_NUM_PAD_ASTERISK",107:"KEY_NUM_PAD_PLUS_SIGN",109:"KEY_NUM_PAD_HYPHEN-MINUS",110:"KEY_NUM_PAD_FULL_STOP",111:"KEY_NUM_PAD_SOLIDUS",144:"KEY_NUM_LOCK",145:"KEY_SCROLL_LOCK",186:"KEY_SEMICOLON",187:"KEY_EQUALS_SIGN",188:"KEY_COMMA",189:"KEY_HYPHEN-MINUS",190:"KEY_FULL_STOP",191:"KEY_SOLIDUS",192:"KEY_GRAVE_ACCENT",219:"KEY_LEFT_SQUARE_BRACKET",220:"KEY_REVERSE_SOLIDUS",221:"KEY_RIGHT_SQUARE_BRACKET",222:"KEY_APOSTROPHE"};(function(){var C=MochiKit.Signal._specialKeys;for(var B=48;B<=57;B++){C[B]="KEY_"+(B-48)}for(B=65;B<=90;B++){C[B]="KEY_"+String.fromCharCode(B)}for(B=96;B<=105;B++){C[B]="KEY_NUM_PAD_"+(B-96)}for(B=112;B<=123;B++){C[B]="KEY_F"+(B-112+1)}})();MochiKit.Signal.Ident=function(B){this.source=B.source;this.signal=B.signal;this.listener=B.listener;this.isDOM=B.isDOM;this.objOrFunc=B.objOrFunc;this.funcOrStr=B.funcOrStr;this.connected=B.connected};MochiKit.Signal.Ident.prototype={};MochiKit.Base.update(MochiKit.Signal,{__repr__:function(){return"["+this.NAME+" "+this.VERSION+"]"},toString:function(){return this.__repr__()},_unloadCache:function(){var C=MochiKit.Signal;var B=C._observers;for(var D=0;D<B.length;D++){if(B[D].signal!=="onload"&&B[D].signal!=="onunload"){C._disconnect(B[D])}}},_listener:function(I,H,D,G,B){var C=MochiKit.Signal;var F=C.Event;if(!B){if(typeof (D.im_self)=="undefined"){return MochiKit.Base.bind(D,G)}else{return D}}G=G||I;if(typeof (D)=="string"){if(H==="onload"||H==="onunload"){return function(J){G[D].apply(G,[new F(I,J)]);var E=new MochiKit.Signal.Ident({source:I,signal:H,objOrFunc:G,funcOrStr:D});MochiKit.Signal._disconnect(E)}}else{return function(E){G[D].apply(G,[new F(I,E)])}}}else{if(H==="onload"||H==="onunload"){return function(J){D.apply(G,[new F(I,J)]);var E=new MochiKit.Signal.Ident({source:I,signal:H,objOrFunc:D});MochiKit.Signal._disconnect(E)}}else{return function(E){D.apply(G,[new F(I,E)])}}}},_browserAlreadyHasMouseEnterAndLeave:function(){return/MSIE/.test(navigator.userAgent)},_mouseEnterListener:function(G,F,B,D){var C=MochiKit.Signal.Event;return function(H){var I=new C(G,H);try{I.relatedTarget().nodeName}catch(E){return }I.stop();if(MochiKit.DOM.isChildNode(I.relatedTarget(),G)){return }I.type=function(){return F};if(typeof (B)=="string"){return D[B].apply(D,[I])}else{return B.apply(D,[I])}}},_getDestPair:function(E,D){var C=null;var B=null;if(typeof (D)!="undefined"){C=E;B=D;if(typeof (D)=="string"){if(typeof (E[D])!="function"){throw new Error("'funcOrStr' must be a function on 'objOrFunc'")}}else{if(typeof (D)!="function"){throw new Error("'funcOrStr' must be a function or string")}}}else{if(typeof (E)!="function"){throw new Error("'objOrFunc' must be a function if 'funcOrStr' is not given")}else{B=E}}return[C,B]},connect:function(C,M,H,G){C=MochiKit.DOM.getElement(C);var K=MochiKit.Signal;if(typeof (M)!="string"){throw new Error("'sig' must be a string")}var E=K._getDestPair(H,G);var I=E[0];var F=E[1];if(typeof (I)=="undefined"||I===null){I=C}var D=!!(C.addEventListener||C.attachEvent);if(D&&(M==="onmouseenter"||M==="onmouseleave")&&!K._browserAlreadyHasMouseEnterAndLeave()){var B=K._mouseEnterListener(C,M.substr(2),F,I);if(M==="onmouseenter"){M="onmouseover"}else{M="onmouseout"}}else{var B=K._listener(C,M,F,I,D)}if(C.addEventListener){C.addEventListener(M.substr(2),B,false)}else{if(C.attachEvent){C.attachEvent(M,B)}}var L=new MochiKit.Signal.Ident({source:C,signal:M,listener:B,isDOM:D,objOrFunc:H,funcOrStr:G,connected:true});K._observers.push(L);if(!D&&typeof (C.__connect__)=="function"){var J=MochiKit.Base.extend([L],arguments,1);C.__connect__.apply(C,J)}return L},_disconnect:function(B){if(!B.connected){return }B.connected=false;if(!B.isDOM){return }var E=B.source;var D=B.signal;var C=B.listener;if(E.removeEventListener){E.removeEventListener(D.substr(2),C,false)}else{if(E.detachEvent){E.detachEvent(D,C)}else{throw new Error("'src' must be a DOM element")}}},disconnect:function(C){var J=MochiKit.Signal;var L=J._observers;var F=MochiKit.Base;if(arguments.length>1){var B=MochiKit.DOM.getElement(arguments[0]);var K=arguments[1];var H=arguments[2];var E=arguments[3];for(var G=L.length-1;G>=0;G--){var D=L[G];if(D.source===B&&D.signal===K&&D.objOrFunc===H&&D.funcOrStr===E){J._disconnect(D);if(!J._lock){L.splice(G,1)}else{J._dirty=true}return true}}}else{var I=F.findIdentical(L,C);if(I>=0){J._disconnect(C);if(!J._lock){L.splice(I,1)}else{J._dirty=true}return true}}return false},disconnectAllTo:function(I,H){var J=MochiKit.Signal;var G=J._observers;var F=J._disconnect;var D=J._lock;var E=J._dirty;if(typeof (H)==="undefined"){H=null}for(var B=G.length-1;B>=0;B--){var C=G[B];if(C.objOrFunc===I&&(H===null||C.funcOrStr===H)){F(C);if(D){E=true}else{G.splice(B,1)}}}J._dirty=E},disconnectAll:function(B,M){B=MochiKit.DOM.getElement(B);var C=MochiKit.Base;var G=C.flattenArguments(C.extend(null,arguments,1));var K=MochiKit.Signal;var E=K._disconnect;var D=K._observers;var H,J;var I=K._lock;var F=K._dirty;if(G.length===0){for(H=D.length-1;H>=0;H--){J=D[H];if(J.source===B){E(J);if(!I){D.splice(H,1)}else{F=true}}}}else{var L={};for(H=0;H<G.length;H++){L[G[H]]=true}for(H=D.length-1;H>=0;H--){J=D[H];if(J.source===B&&J.signal in L){E(J);if(!I){D.splice(H,1)}else{F=true}}}}K._dirty=F},signal:function(B,J){var I=MochiKit.Signal;var E=I._observers;B=MochiKit.DOM.getElement(B);var H=MochiKit.Base.extend(null,arguments,2);var D=[];I._lock=true;for(var F=0;F<E.length;F++){var C=E[F];if(C.source===B&&C.signal===J&&C.connected){try{C.listener.apply(B,H)}catch(G){D.push(G)}}}I._lock=false;if(I._dirty){I._dirty=false;for(var F=E.length-1;F>=0;F--){if(!E[F].connected){E.splice(F,1)}}}if(D.length==1){throw D[0]}else{if(D.length>1){var G=new Error("Multiple errors thrown in handling 'sig', see errors property");G.errors=D;throw G}}}});MochiKit.Signal.EXPORT_OK=[];MochiKit.Signal.EXPORT=["connect","disconnect","signal","disconnectAll","disconnectAllTo"];MochiKit.Signal.__new__=function(D){var B=MochiKit.Base;this._document=document;this._window=D;this._lock=false;this._dirty=false;try{this.connect(window,"onunload",this._unloadCache)}catch(C){}this.EXPORT_TAGS={":common":this.EXPORT,":all":B.concat(this.EXPORT,this.EXPORT_OK)};B.nameFunctions(this)};MochiKit.Signal.__new__(this);if(MochiKit.__export__){connect=MochiKit.Signal.connect;disconnect=MochiKit.Signal.disconnect;disconnectAll=MochiKit.Signal.disconnectAll;signal=MochiKit.Signal.signal}MochiKit.Base._exportSymbols(this,MochiKit.Signal);if(typeof (dojo)!="undefined"){dojo.provide("MochiKit.Visual");dojo.require("MochiKit.Base");dojo.require("MochiKit.DOM");dojo.require("MochiKit.Style");dojo.require("MochiKit.Color");dojo.require("MochiKit.Position")}if(typeof (JSAN)!="undefined"){JSAN.use("MochiKit.Base",[]);JSAN.use("MochiKit.DOM",[]);JSAN.use("MochiKit.Style",[]);JSAN.use("MochiKit.Color",[]);JSAN.use("MochiKit.Position",[])}try{if(typeof (MochiKit.Base)==="undefined"||typeof (MochiKit.DOM)==="undefined"||typeof (MochiKit.Style)==="undefined"||typeof (MochiKit.Position)==="undefined"||typeof (MochiKit.Color)==="undefined"){throw""}}catch(e){throw"MochiKit.Visual depends on MochiKit.Base, MochiKit.DOM, MochiKit.Style, MochiKit.Position and MochiKit.Color!"}if(typeof (MochiKit.Visual)=="undefined"){MochiKit.Visual={}}MochiKit.Visual.NAME="MochiKit.Visual";MochiKit.Visual.VERSION="1.4";MochiKit.Visual.__repr__=function(){return"["+this.NAME+" "+this.VERSION+"]"};MochiKit.Visual.toString=function(){return this.__repr__()};MochiKit.Visual._RoundCorners=function(F,E){F=MochiKit.DOM.getElement(F);this._setOptions(E);if(this.options.__unstable__wrapElement){F=this._doWrap(F)}var D=this.options.color;var G=MochiKit.Color.Color;if(this.options.color==="fromElement"){D=G.fromBackground(F)}else{if(!(D instanceof G)){D=G.fromString(D)}}this.isTransparent=(D.asRGB().a<=0);var B=this.options.bgColor;if(this.options.bgColor==="fromParent"){B=G.fromBackground(F.offsetParent)}else{if(!(B instanceof G)){B=G.fromString(B)}}this._roundCornersImpl(F,D,B)};MochiKit.Visual._RoundCorners.prototype={_doWrap:function(F){var D=F.parentNode;var E=MochiKit.DOM.currentDocument();if(typeof (E.defaultView)==="undefined"||E.defaultView===null){return F}var C=E.defaultView.getComputedStyle(F,null);if(typeof (C)==="undefined"||C===null){return F}var B=MochiKit.DOM.DIV({style:{display:"block",marginTop:C.getPropertyValue("padding-top"),marginRight:C.getPropertyValue("padding-right"),marginBottom:C.getPropertyValue("padding-bottom"),marginLeft:C.getPropertyValue("padding-left"),padding:"0px"}});B.innerHTML=F.innerHTML;F.innerHTML="";F.appendChild(B);return F},_roundCornersImpl:function(B,D,C){if(this.options.border){this._renderBorder(B,C)}if(this._isTopRounded()){this._roundTopCorners(B,D,C)}if(this._isBottomRounded()){this._roundBottomCorners(B,D,C)}},_renderBorder:function(B,D){var C="1px solid "+this._borderColor(D);var G="border-left: "+C;var F="border-right: "+C;var E="style='"+G+";"+F+"'";B.innerHTML="<div "+E+">"+B.innerHTML+"</div>"},_roundTopCorners:function(D,F,C){var E=this._createCorner(C);for(var B=0;B<this.options.numSlices;B++){E.appendChild(this._createCornerSlice(F,C,B,"top"))}D.style.paddingTop=0;D.insertBefore(E,D.firstChild)},_roundBottomCorners:function(F,D,C){var B=this._createCorner(C);for(var E=(this.options.numSlices-1);E>=0;E--){B.appendChild(this._createCornerSlice(D,C,E,"bottom"))}F.style.paddingBottom=0;F.appendChild(B)},_createCorner:function(C){var B=MochiKit.DOM;return B.DIV({style:{backgroundColor:C.toString()}})},_createCornerSlice:function(E,B,H,G){var F=MochiKit.DOM.SPAN();var D=F.style;D.backgroundColor=E.toString();D.display="block";D.height="1px";D.overflow="hidden";D.fontSize="1px";var C=this._borderColor(E,B);if(this.options.border&&H===0){D.borderTopStyle="solid";D.borderTopWidth="1px";D.borderLeftWidth="0px";D.borderRightWidth="0px";D.borderBottomWidth="0px";D.height="0px";D.borderColor=C.toString()}else{if(C){D.borderColor=C.toString();D.borderStyle="solid";D.borderWidth="0px 1px"}}if(!this.options.compact&&(H==(this.options.numSlices-1))){D.height="2px"}this._setMargin(F,H,G);this._setBorder(F,H,G);return F},_setOptions:function(B){this.options={corners:"all",color:"fromElement",bgColor:"fromParent",blend:true,border:false,compact:false,__unstable__wrapElement:false};MochiKit.Base.update(this.options,B);this.options.numSlices=(this.options.compact?2:4)},_whichSideTop:function(){var D=this.options.corners;if(this._hasString(D,"all","top")){return""}var C=(D.indexOf("tl")!=-1);var B=(D.indexOf("tr")!=-1);if(C&&B){return""}if(C){return"left"}if(B){return"right"}return""},_whichSideBottom:function(){var D=this.options.corners;if(this._hasString(D,"all","bottom")){return""}var C=(D.indexOf("bl")!=-1);var B=(D.indexOf("br")!=-1);if(C&&B){return""}if(C){return"left"}if(B){return"right"}return""},_borderColor:function(C,B){if(C=="transparent"){return B}else{if(this.options.border){return this.options.border}else{if(this.options.blend){return B.blendedColor(C)}}}return""},_setMargin:function(E,G,D){var C=this._marginSize(G)+"px";var B=(D=="top"?this._whichSideTop():this._whichSideBottom());var F=E.style;if(B=="left"){F.marginLeft=C;F.marginRight="0px"}else{if(B=="right"){F.marginRight=C;F.marginLeft="0px"}else{F.marginLeft=C;F.marginRight=C}}},_setBorder:function(B,G,F){var E=this._borderSize(G)+"px";var D=(F=="top"?this._whichSideTop():this._whichSideBottom());var C=B.style;if(D=="left"){C.borderLeftWidth=E;C.borderRightWidth="0px"}else{if(D=="right"){C.borderRightWidth=E;C.borderLeftWidth="0px"}else{C.borderLeftWidth=E;C.borderRightWidth=E}}},_marginSize:function(G){if(this.isTransparent){return 0}var F=this.options;if(F.compact&&F.blend){var D=[1,0];return D[G]}else{if(F.compact){var C=[2,1];return C[G]}else{if(F.blend){var B=[3,2,1,0];return B[G]}else{var E=[5,3,2,1];return E[G]}}}},_borderSize:function(D){var C=this.options;var B;if(C.compact&&(C.blend||this.isTransparent)){return 1}else{if(C.compact){B=[1,0]}else{if(C.blend){B=[2,1,1,1]}else{if(C.border){B=[0,2,0,0]}else{if(this.isTransparent){B=[5,3,2,1]}else{return 0}}}}}return B[D]},_hasString:function(C){for(var B=1;B<arguments.length;B++){if(C.indexOf(arguments[B])!=-1){return true}}return false},_isTopRounded:function(){return this._hasString(this.options.corners,"all","top","tl","tr")},_isBottomRounded:function(){return this._hasString(this.options.corners,"all","bottom","bl","br")},_hasSingleTextChild:function(B){return(B.childNodes.length==1&&B.childNodes[0].nodeType==3)}};MochiKit.Visual.roundElement=function(B,C){new MochiKit.Visual._RoundCorners(B,C)};MochiKit.Visual.roundClass=function(F,E,D){var C=MochiKit.DOM.getElementsByTagAndClassName(F,E);for(var B=0;B<C.length;B++){MochiKit.Visual.roundElement(C[B],D)}};MochiKit.Visual.tagifyText=function(C,B){B=B||"position:relative";if(/MSIE/.test(navigator.userAgent)){B+=";zoom:1"}C=MochiKit.DOM.getElement(C);var D=MochiKit.Base.map;D(function(E){if(E.nodeType==3){D(function(F){C.insertBefore(MochiKit.DOM.SPAN({style:B},F==" "?String.fromCharCode(160):F),E)},E.nodeValue.split(""));MochiKit.DOM.removeElement(E)}},C.childNodes)};MochiKit.Visual.forceRerendering=function(B){try{B=MochiKit.DOM.getElement(B);var D=document.createTextNode(" ");B.appendChild(D);B.removeChild(D)}catch(C){}};MochiKit.Visual.multiple=function(D,F,E){E=MochiKit.Base.update({speed:0.1,delay:0},E);var C=E.delay;var B=0;MochiKit.Base.map(function(G){E.delay=B*E.speed+C;new F(G,E);B+=1},D)};MochiKit.Visual.PAIRS={slide:["slideDown","slideUp"],blind:["blindDown","blindUp"],appear:["appear","fade"],size:["grow","shrink"]};MochiKit.Visual.toggle=function(E,D,C){E=MochiKit.DOM.getElement(E);D=(D||"appear").toLowerCase();C=MochiKit.Base.update({queue:{position:"end",scope:(E.id||"global"),limit:1}},C);var B=MochiKit.Visual;B[MochiKit.Style.getStyle(E,"display")!="none"?B.PAIRS[D][1]:B.PAIRS[D][0]](E,C)};MochiKit.Visual.Transitions={};MochiKit.Visual.Transitions.linear=function(B){return B};MochiKit.Visual.Transitions.sinoidal=function(B){return(-Math.cos(B*Math.PI)/2)+0.5};MochiKit.Visual.Transitions.reverse=function(B){return 1-B};MochiKit.Visual.Transitions.flicker=function(B){return((-Math.cos(B*Math.PI)/4)+0.75)+Math.random()/4};MochiKit.Visual.Transitions.wobble=function(B){return(-Math.cos(B*Math.PI*(9*B))/2)+0.5};MochiKit.Visual.Transitions.pulse=function(C,B){if(!B){return(Math.floor(C*10)%2===0?(C*10-Math.floor(C*10)):1-(C*10-Math.floor(C*10)))}return(Math.round((C%(1/B))*B)==0?((C*B*2)-Math.floor(C*B*2)):1-((C*B*2)-Math.floor(C*B*2)))};MochiKit.Visual.Transitions.none=function(B){return 0};MochiKit.Visual.Transitions.full=function(B){return 1};MochiKit.Visual.ScopedQueue=function(){var B=arguments.callee;if(!(this instanceof B)){return new B()}this.__init__()};MochiKit.Base.update(MochiKit.Visual.ScopedQueue.prototype,{__init__:function(){this.effects=[];this.interval=null},add:function(D){var C=new Date().getTime();var B=(typeof (D.options.queue)=="string")?D.options.queue:D.options.queue.position;var F=MochiKit.Base.map;switch(B){case"front":F(function(G){if(G.state=="idle"){G.startOn+=D.finishOn;G.finishOn+=D.finishOn}},this.effects);break;case"end":var E;F(function(H){var G=H.finishOn;if(G>=(E||G)){E=G}},this.effects);C=E||C;break;case"break":F(function(G){G.finalize()},this.effects);break}D.startOn+=C;D.finishOn+=C;if(!D.options.queue.limit||this.effects.length<D.options.queue.limit){this.effects.push(D)}if(!this.interval){this.interval=this.startLoop(MochiKit.Base.bind(this.loop,this),40)}},startLoop:function(B,C){return setInterval(B,C)},remove:function(B){this.effects=MochiKit.Base.filter(function(C){return C!=B},this.effects);if(!this.effects.length){this.stopLoop(this.interval);this.interval=null}},stopLoop:function(B){clearInterval(B)},loop:function(){var B=new Date().getTime();MochiKit.Base.map(function(C){C.loop(B)},this.effects)}});MochiKit.Visual.Queues={instances:{},get:function(B){if(typeof (B)!="string"){return B}if(!this.instances[B]){this.instances[B]=new MochiKit.Visual.ScopedQueue()}return this.instances[B]}};MochiKit.Visual.Queue=MochiKit.Visual.Queues.get("global");MochiKit.Visual.DefaultOptions={transition:MochiKit.Visual.Transitions.sinoidal,duration:1,fps:25,sync:false,from:0,to:1,delay:0,queue:"parallel"};MochiKit.Visual.Base=function(){};MochiKit.Visual.Base.prototype={__class__:MochiKit.Visual.Base,start:function(C){var B=MochiKit.Visual;this.options=MochiKit.Base.setdefault(C,B.DefaultOptions);this.currentFrame=0;this.state="idle";this.startOn=this.options.delay*1000;this.finishOn=this.startOn+(this.options.duration*1000);this.event("beforeStart");if(!this.options.sync){B.Queues.get(typeof (this.options.queue)=="string"?"global":this.options.queue.scope).add(this)}},loop:function(C){if(C>=this.startOn){if(C>=this.finishOn){return this.finalize()}var D=(C-this.startOn)/(this.finishOn-this.startOn);var B=Math.round(D*this.options.fps*this.options.duration);if(B>this.currentFrame){this.render(D);this.currentFrame=B}}},render:function(B){if(this.state=="idle"){this.state="running";this.event("beforeSetup");this.setup();this.event("afterSetup")}if(this.state=="running"){if(this.options.transition){B=this.options.transition(B)}B*=(this.options.to-this.options.from);B+=this.options.from;this.event("beforeUpdate");this.update(B);this.event("afterUpdate")}},cancel:function(){if(!this.options.sync){MochiKit.Visual.Queues.get(typeof (this.options.queue)=="string"?"global":this.options.queue.scope).remove(this)}this.state="finished"},finalize:function(){this.render(1);this.cancel();this.event("beforeFinish");this.finish();this.event("afterFinish")},setup:function(){},finish:function(){},update:function(B){},event:function(B){if(this.options[B+"Internal"]){this.options[B+"Internal"](this)}if(this.options[B]){this.options[B](this)}},repr:function(){return"["+this.__class__.NAME+", options:"+MochiKit.Base.repr(this.options)+"]"}};MochiKit.Visual.Parallel=function(D,B){var C=arguments.callee;if(!(this instanceof C)){return new C(D,B)}this.__init__(D,B)};MochiKit.Visual.Parallel.prototype=new MochiKit.Visual.Base();MochiKit.Base.update(MochiKit.Visual.Parallel.prototype,{__class__:MochiKit.Visual.Parallel,__init__:function(B,C){this.effects=B||[];this.start(C)},update:function(B){MochiKit.Base.map(function(C){C.render(B)},this.effects)},finish:function(){MochiKit.Base.map(function(B){B.finalize()},this.effects)}});MochiKit.Visual.Opacity=function(D,C){var B=arguments.callee;if(!(this instanceof B)){return new B(D,C)}this.__init__(D,C)};MochiKit.Visual.Opacity.prototype=new MochiKit.Visual.Base();MochiKit.Base.update(MochiKit.Visual.Opacity.prototype,{__class__:MochiKit.Visual.Opacity,__init__:function(D,C){var B=MochiKit.Base;var E=MochiKit.Style;this.element=MochiKit.DOM.getElement(D);if(this.element.currentStyle&&(!this.element.currentStyle.hasLayout)){E.setStyle(this.element,{zoom:1})}C=B.update({from:E.getStyle(this.element,"opacity")||0,to:1},C);this.start(C)},update:function(B){MochiKit.Style.setStyle(this.element,{opacity:B})}});MochiKit.Visual.Move=function(D,C){var B=arguments.callee;if(!(this instanceof B)){return new B(D,C)}this.__init__(D,C)};MochiKit.Visual.Move.prototype=new MochiKit.Visual.Base();MochiKit.Base.update(MochiKit.Visual.Move.prototype,{__class__:MochiKit.Visual.Move,__init__:function(B,C){this.element=MochiKit.DOM.getElement(B);C=MochiKit.Base.update({x:0,y:0,mode:"relative"},C);this.start(C)},setup:function(){MochiKit.DOM.makePositioned(this.element);var B=this.element.style;var D=B.visibility;var C=B.display;if(C=="none"){B.visibility="hidden";B.display=""}this.originalLeft=parseFloat(MochiKit.Style.getStyle(this.element,"left")||"0");this.originalTop=parseFloat(MochiKit.Style.getStyle(this.element,"top")||"0");if(this.options.mode=="absolute"){this.options.x-=this.originalLeft;this.options.y-=this.originalTop}if(C=="none"){B.visibility=D;B.display=C}},update:function(B){MochiKit.Style.setStyle(this.element,{left:Math.round(this.options.x*B+this.originalLeft)+"px",top:Math.round(this.options.y*B+this.originalTop)+"px"})}});MochiKit.Visual.Scale=function(E,D,C){var B=arguments.callee;if(!(this instanceof B)){return new B(E,D,C)}this.__init__(E,D,C)};MochiKit.Visual.Scale.prototype=new MochiKit.Visual.Base();MochiKit.Base.update(MochiKit.Visual.Scale.prototype,{__class__:MochiKit.Visual.Scale,__init__:function(B,D,C){this.element=MochiKit.DOM.getElement(B);C=MochiKit.Base.update({scaleX:true,scaleY:true,scaleContent:true,scaleFromCenter:false,scaleMode:"box",scaleFrom:100,scaleTo:D},C);this.start(C)},setup:function(){this.restoreAfterFinish=this.options.restoreAfterFinish||false;this.elementPositioning=MochiKit.Style.getStyle(this.element,"position");var D=MochiKit.Base.map;var B=MochiKit.Base.bind;this.originalStyle={};D(B(function(E){this.originalStyle[E]=this.element.style[E]},this),["top","left","width","height","fontSize"]);this.originalTop=this.element.offsetTop;this.originalLeft=this.element.offsetLeft;var C=MochiKit.Style.getStyle(this.element,"font-size")||"100%";D(B(function(E){if(C.indexOf(E)>0){this.fontSize=parseFloat(C);this.fontSizeType=E}},this),["em","px","%"]);this.factor=(this.options.scaleTo-this.options.scaleFrom)/100;if(/^content/.test(this.options.scaleMode)){this.dims=[this.element.scrollHeight,this.element.scrollWidth]}else{if(this.options.scaleMode=="box"){this.dims=[this.element.offsetHeight,this.element.offsetWidth]}else{this.dims=[this.options.scaleMode.originalHeight,this.options.scaleMode.originalWidth]}}},update:function(C){var B=(this.options.scaleFrom/100)+(this.factor*C);if(this.options.scaleContent&&this.fontSize){MochiKit.Style.setStyle(this.element,{fontSize:this.fontSize*B+this.fontSizeType})}this.setDimensions(this.dims[0]*B,this.dims[1]*B)},finish:function(){if(this.restoreAfterFinish){MochiKit.Style.setStyle(this.element,this.originalStyle)}},setDimensions:function(B,G){var F={};var E=Math.round;if(/MSIE/.test(navigator.userAgent)){E=Math.ceil}if(this.options.scaleX){F.width=E(G)+"px"}if(this.options.scaleY){F.height=E(B)+"px"}if(this.options.scaleFromCenter){var C=(B-this.dims[0])/2;var D=(G-this.dims[1])/2;if(this.elementPositioning=="absolute"){if(this.options.scaleY){F.top=this.originalTop-C+"px"}if(this.options.scaleX){F.left=this.originalLeft-D+"px"}}else{if(this.options.scaleY){F.top=-C+"px"}if(this.options.scaleX){F.left=-D+"px"}}}MochiKit.Style.setStyle(this.element,F)}});MochiKit.Visual.Highlight=function(C,D){var B=arguments.callee;if(!(this instanceof B)){return new B(C,D)}this.__init__(C,D)};MochiKit.Visual.Highlight.prototype=new MochiKit.Visual.Base();MochiKit.Base.update(MochiKit.Visual.Highlight.prototype,{__class__:MochiKit.Visual.Highlight,__init__:function(C,B){this.element=MochiKit.DOM.getElement(C);B=MochiKit.Base.update({startcolor:"#ffff99"},B);this.start(B)},setup:function(){var B=MochiKit.Base;var C=MochiKit.Style;if(C.getStyle(this.element,"display")=="none"){this.cancel();return }this.oldStyle={backgroundImage:C.getStyle(this.element,"background-image")};C.setStyle(this.element,{backgroundImage:"none"});if(!this.options.endcolor){this.options.endcolor=MochiKit.Color.Color.fromBackground(this.element).toHexString()}if(B.isUndefinedOrNull(this.options.restorecolor)){this.options.restorecolor=C.getStyle(this.element,"background-color")}this._base=B.map(B.bind(function(D){return parseInt(this.options.startcolor.slice(D*2+1,D*2+3),16)},this),[0,1,2]);this._delta=B.map(B.bind(function(D){return parseInt(this.options.endcolor.slice(D*2+1,D*2+3),16)-this._base[D]},this),[0,1,2])},update:function(C){var B="#";MochiKit.Base.map(MochiKit.Base.bind(function(D){B+=MochiKit.Color.toColorPart(Math.round(this._base[D]+this._delta[D]*C))},this),[0,1,2]);MochiKit.Style.setStyle(this.element,{backgroundColor:B})},finish:function(){MochiKit.Style.setStyle(this.element,MochiKit.Base.update(this.oldStyle,{backgroundColor:this.options.restorecolor}))}});MochiKit.Visual.ScrollTo=function(D,C){var B=arguments.callee;if(!(this instanceof B)){return new B(D,C)}this.__init__(D,C)};MochiKit.Visual.ScrollTo.prototype=new MochiKit.Visual.Base();MochiKit.Base.update(MochiKit.Visual.ScrollTo.prototype,{__class__:MochiKit.Visual.ScrollTo,__init__:function(C,B){this.element=MochiKit.DOM.getElement(C);this.start(B)},setup:function(){var D=MochiKit.Position;D.prepare();var C=D.cumulativeOffset(this.element);if(this.options.offset){C.y+=this.options.offset}var B;if(window.innerHeight){B=window.innerHeight-window.height}else{if(document.documentElement&&document.documentElement.clientHeight){B=document.documentElement.clientHeight-document.body.scrollHeight}else{if(document.body){B=document.body.clientHeight-document.body.scrollHeight}}}this.scrollStart=D.windowOffset.y;this.delta=(C.y>B?B:C.y)-this.scrollStart},update:function(B){var C=MochiKit.Position;C.prepare();window.scrollTo(C.windowOffset.x,this.scrollStart+(B*this.delta))}});MochiKit.Visual.CSS_LENGTH=/^(([\+\-]?[0-9\.]+)(em|ex|px|in|cm|mm|pt|pc|\%))|0$/;MochiKit.Visual.Morph=function(C,D){var B=arguments.callee;if(!(this instanceof B)){return new B(C,D)}this.__init__(C,D)};MochiKit.Visual.Morph.prototype=new MochiKit.Visual.Base();MochiKit.Base.update(MochiKit.Visual.Morph.prototype,{__class__:MochiKit.Visual.Morph,__init__:function(C,B){this.element=MochiKit.DOM.getElement(C);this.start(B)},setup:function(){var B=MochiKit.Base;var G=this.options.style;this.styleStart={};this.styleEnd={};this.units={};var F,E;for(var D in G){F=G[D];D=B.camelize(D);if(MochiKit.Visual.CSS_LENGTH.test(F)){var C=F.match(/^([\+\-]?[0-9\.]+)(.*)$/);F=parseFloat(C[1]);E=(C.length==3)?C[2]:null;this.styleEnd[D]=F;this.units[D]=E;F=MochiKit.Style.getStyle(this.element,D);C=F.match(/^([\+\-]?[0-9\.]+)(.*)$/);F=parseFloat(C[1]);this.styleStart[D]=F}else{var H=MochiKit.Color.Color;F=H.fromString(F);if(F){this.units[D]="color";this.styleEnd[D]=F.toHexString();F=MochiKit.Style.getStyle(this.element,D);this.styleStart[D]=H.fromString(F).toHexString();this.styleStart[D]=B.map(B.bind(function(I){return parseInt(this.styleStart[D].slice(I*2+1,I*2+3),16)},this),[0,1,2]);this.styleEnd[D]=B.map(B.bind(function(I){return parseInt(this.styleEnd[D].slice(I*2+1,I*2+3),16)},this),[0,1,2])}}}},update:function(G){var F;for(var E in this.styleStart){if(this.units[E]=="color"){var B="#";var D=this.styleStart[E];var C=this.styleEnd[E];MochiKit.Base.map(MochiKit.Base.bind(function(H){B+=MochiKit.Color.toColorPart(Math.round(D[H]+(C[H]-D[H])*G))},this),[0,1,2]);this.element.style[E]=B}else{F=this.styleStart[E]+Math.round((this.styleEnd[E]-this.styleStart[E])*G*1000)/1000+this.units[E];this.element.style[E]=F}}}});MochiKit.Visual.fade=function(C,B){var D=MochiKit.Style;var E=D.getStyle(C,"opacity");B=MochiKit.Base.update({from:D.getStyle(C,"opacity")||1,to:0,afterFinishInternal:function(F){if(F.options.to!==0){return }D.hideElement(F.element);D.setStyle(F.element,{opacity:E})}},B);return new MochiKit.Visual.Opacity(C,B)};MochiKit.Visual.appear=function(E,B){var D=MochiKit.Style;var C=MochiKit.Visual;B=MochiKit.Base.update({from:(D.getStyle(E,"display")=="none"?0:D.getStyle(E,"opacity")||0),to:1,afterFinishInternal:function(F){C.forceRerendering(F.element)},beforeSetupInternal:function(F){D.setStyle(F.element,{opacity:F.options.from});D.showElement(F.element)}},B);return new C.Opacity(E,B)};MochiKit.Visual.puff=function(E,F){var D=MochiKit.Style;var B=MochiKit.Visual;E=MochiKit.DOM.getElement(E);var C={position:D.getStyle(E,"position"),top:E.style.top,left:E.style.left,width:E.style.width,height:E.style.height,opacity:D.getStyle(E,"opacity")};F=MochiKit.Base.update({beforeSetupInternal:function(G){MochiKit.Position.absolutize(G.effects[0].element)},afterFinishInternal:function(G){D.hideElement(G.effects[0].element);D.setStyle(G.effects[0].element,C)},scaleContent:true,scaleFromCenter:true},F);return new B.Parallel([new B.Scale(E,200,{sync:true,scaleFromCenter:F.scaleFromCenter,scaleContent:F.scaleContent,restoreAfterFinish:true}),new B.Opacity(E,{sync:true,to:0})],F)};MochiKit.Visual.blindUp=function(C,B){var E=MochiKit.DOM;C=E.getElement(C);var D=E.makeClipping(C);B=MochiKit.Base.update({scaleContent:false,scaleX:false,restoreAfterFinish:true,afterFinishInternal:function(F){MochiKit.Style.hideElement(F.element);E.undoClipping(F.element,D)}},B);return new MochiKit.Visual.Scale(C,0,B)};MochiKit.Visual.blindDown=function(C,B){var G=MochiKit.DOM;var D=MochiKit.Style;C=G.getElement(C);var E=D.getElementDimensions(C);var F;B=MochiKit.Base.update({scaleContent:false,scaleX:false,scaleFrom:0,scaleMode:{originalHeight:E.h,originalWidth:E.w},restoreAfterFinish:true,afterSetupInternal:function(H){F=G.makeClipping(H.element);D.setStyle(H.element,{height:"0px"});D.showElement(H.element)},afterFinishInternal:function(H){G.undoClipping(H.element,F)}},B);return new MochiKit.Visual.Scale(C,100,B)};MochiKit.Visual.switchOff=function(F,E){var G=MochiKit.DOM;F=G.getElement(F);var D=MochiKit.Style.getStyle(F,"opacity");var C;E=MochiKit.Base.update({duration:0.3,scaleFromCenter:true,scaleX:false,scaleContent:false,restoreAfterFinish:true,beforeSetupInternal:function(H){G.makePositioned(H.element);C=G.makeClipping(H.element)},afterFinishInternal:function(H){MochiKit.Style.hideElement(H.element);G.undoClipping(H.element,C);G.undoPositioned(H.element);MochiKit.Style.setStyle(H.element,{opacity:D})}},E);var B=MochiKit.Visual;return new B.appear(F,{duration:0.4,from:0,transition:B.Transitions.flicker,afterFinishInternal:function(H){new B.Scale(H.element,1,E)}})};MochiKit.Visual.dropOut=function(E,C){var G=MochiKit.DOM;var F=MochiKit.Style;E=G.getElement(E);var B={top:F.getStyle(E,"top"),left:F.getStyle(E,"left"),opacity:F.getStyle(E,"opacity")};C=MochiKit.Base.update({duration:0.5,distance:100,beforeSetupInternal:function(H){G.makePositioned(H.effects[0].element)},afterFinishInternal:function(H){F.hideElement(H.effects[0].element);G.undoPositioned(H.effects[0].element);F.setStyle(H.effects[0].element,B)}},C);var D=MochiKit.Visual;return new D.Parallel([new D.Move(E,{x:0,y:C.distance,sync:true}),new D.Opacity(E,{sync:true,to:0})],C)};MochiKit.Visual.shake=function(F,E){var G=MochiKit.DOM;var B=MochiKit.Visual;var C=MochiKit.Style;F=G.getElement(F);E=MochiKit.Base.update({x:-20,y:0,duration:0.05,afterFinishInternal:function(H){G.undoPositioned(H.element);C.setStyle(H.element,D)}},E);var D={top:C.getStyle(F,"top"),left:C.getStyle(F,"left")};return new B.Move(F,{x:20,y:0,duration:0.05,afterFinishInternal:function(H){new B.Move(H.element,{x:-40,y:0,duration:0.1,afterFinishInternal:function(I){new B.Move(I.element,{x:40,y:0,duration:0.1,afterFinishInternal:function(J){new B.Move(J.element,{x:-40,y:0,duration:0.1,afterFinishInternal:function(K){new B.Move(K.element,{x:40,y:0,duration:0.1,afterFinishInternal:function(L){new B.Move(L.element,E)}})}})}})}})}})};MochiKit.Visual.slideDown=function(D,C){var I=MochiKit.DOM;var B=MochiKit.Base;var E=MochiKit.Style;D=I.getElement(D);if(!D.firstChild){throw"MochiKit.Visual.slideDown must be used on a element with a child"}I.removeEmptyTextNodes(D);var H=E.getStyle(D.firstChild,"bottom")||0;var G=E.getElementDimensions(D);var F;C=B.update({scaleContent:false,scaleX:false,scaleFrom:0,scaleMode:{originalHeight:G.h,originalWidth:G.w},restoreAfterFinish:true,afterSetupInternal:function(J){I.makePositioned(J.element);I.makePositioned(J.element.firstChild);if(/Opera/.test(navigator.userAgent)){E.setStyle(J.element,{top:""})}F=I.makeClipping(J.element);E.setStyle(J.element,{height:"0px"});E.showElement(J.element)},afterUpdateInternal:function(J){E.setStyle(J.element.firstChild,{bottom:(J.dims[0]-J.element.clientHeight)+"px"})},afterFinishInternal:function(J){I.undoClipping(J.element,F);if(/MSIE/.test(navigator.userAgent)){I.undoPositioned(J.element);I.undoPositioned(J.element.firstChild)}else{I.undoPositioned(J.element.firstChild);I.undoPositioned(J.element)}E.setStyle(J.element.firstChild,{bottom:H})}},C);return new MochiKit.Visual.Scale(D,100,C)};MochiKit.Visual.slideUp=function(G,F){var H=MochiKit.DOM;var B=MochiKit.Base;var E=MochiKit.Style;G=H.getElement(G);if(!G.firstChild){throw"MochiKit.Visual.slideUp must be used on a element with a child"}H.removeEmptyTextNodes(G);var D=E.getStyle(G.firstChild,"bottom");var C;F=B.update({scaleContent:false,scaleX:false,scaleMode:"box",scaleFrom:100,restoreAfterFinish:true,beforeStartInternal:function(I){H.makePositioned(I.element);H.makePositioned(I.element.firstChild);if(/Opera/.test(navigator.userAgent)){E.setStyle(I.element,{top:""})}C=H.makeClipping(I.element);E.showElement(I.element)},afterUpdateInternal:function(I){E.setStyle(I.element.firstChild,{bottom:(I.dims[0]-I.element.clientHeight)+"px"})},afterFinishInternal:function(I){E.hideElement(I.element);H.undoClipping(I.element,C);H.undoPositioned(I.element.firstChild);H.undoPositioned(I.element);E.setStyle(I.element.firstChild,{bottom:D})}},F);return new MochiKit.Visual.Scale(G,0,F)};MochiKit.Visual.squish=function(F,E){var D=MochiKit.DOM;var B=MochiKit.Base;var C;E=B.update({restoreAfterFinish:true,beforeSetupInternal:function(G){C=D.makeClipping(G.element)},afterFinishInternal:function(G){MochiKit.Style.hideElement(G.element);D.undoClipping(G.element,C)}},E);return new MochiKit.Visual.Scale(F,/Opera/.test(navigator.userAgent)?1:0,E)};MochiKit.Visual.grow=function(E,D){var F=MochiKit.DOM;var I=MochiKit.Visual;var M=MochiKit.Style;E=F.getElement(E);D=MochiKit.Base.update({direction:"center",moveTransition:I.Transitions.sinoidal,scaleTransition:I.Transitions.sinoidal,opacityTransition:I.Transitions.full,scaleContent:true,scaleFromCenter:false},D);var C={top:E.style.top,left:E.style.left,height:E.style.height,width:E.style.width,opacity:M.getStyle(E,"opacity")};var G=M.getElementDimensions(E);var B,L;var K,J;switch(D.direction){case"top-left":B=L=K=J=0;break;case"top-right":B=G.w;L=J=0;K=-G.w;break;case"bottom-left":B=K=0;L=G.h;J=-G.h;break;case"bottom-right":B=G.w;L=G.h;K=-G.w;J=-G.h;break;case"center":B=G.w/2;L=G.h/2;K=-G.w/2;J=-G.h/2;break}var H=MochiKit.Base.update({beforeSetupInternal:function(N){M.setStyle(N.effects[0].element,{height:"0px"});M.showElement(N.effects[0].element)},afterFinishInternal:function(N){F.undoClipping(N.effects[0].element);F.undoPositioned(N.effects[0].element);M.setStyle(N.effects[0].element,C)}},D);return new I.Move(E,{x:B,y:L,duration:0.01,beforeSetupInternal:function(N){M.hideElement(N.element);F.makeClipping(N.element);F.makePositioned(N.element)},afterFinishInternal:function(N){new I.Parallel([new I.Opacity(N.element,{sync:true,to:1,from:0,transition:D.opacityTransition}),new I.Move(N.element,{x:K,y:J,sync:true,transition:D.moveTransition}),new I.Scale(N.element,100,{scaleMode:{originalHeight:G.h,originalWidth:G.w},sync:true,scaleFrom:/Opera/.test(navigator.userAgent)?1:0,transition:D.scaleTransition,scaleContent:D.scaleContent,scaleFromCenter:D.scaleFromCenter,restoreAfterFinish:true})],H)}})};MochiKit.Visual.shrink=function(K,J){var E=MochiKit.DOM;var I=MochiKit.Visual;var L=MochiKit.Style;K=E.getElement(K);J=MochiKit.Base.update({direction:"center",moveTransition:I.Transitions.sinoidal,scaleTransition:I.Transitions.sinoidal,opacityTransition:I.Transitions.none,scaleContent:true,scaleFromCenter:false},J);var G={top:K.style.top,left:K.style.left,height:K.style.height,width:K.style.width,opacity:L.getStyle(K,"opacity")};var H=L.getElementDimensions(K);var F,D;switch(J.direction){case"top-left":F=D=0;break;case"top-right":F=H.w;D=0;break;case"bottom-left":F=0;D=H.h;break;case"bottom-right":F=H.w;D=H.h;break;case"center":F=H.w/2;D=H.h/2;break}var C;var B=MochiKit.Base.update({beforeStartInternal:function(M){C=E.makePositioned(M.effects[0].element);E.makeClipping(M.effects[0].element)},afterFinishInternal:function(M){L.hideElement(M.effects[0].element);E.undoClipping(M.effects[0].element,C);E.undoPositioned(M.effects[0].element);L.setStyle(M.effects[0].element,G)}},J);return new I.Parallel([new I.Opacity(K,{sync:true,to:0,from:1,transition:J.opacityTransition}),new I.Scale(K,/Opera/.test(navigator.userAgent)?1:0,{sync:true,transition:J.scaleTransition,scaleContent:J.scaleContent,scaleFromCenter:J.scaleFromCenter,restoreAfterFinish:true}),new I.Move(K,{x:F,y:D,sync:true,transition:J.moveTransition})],B)};MochiKit.Visual.pulsate=function(I,E){var F=MochiKit.DOM;var D=MochiKit.Visual;var C=MochiKit.Base;var H=MochiKit.Style.getStyle(I,"opacity");E=C.update({duration:3,from:0,afterFinishInternal:function(J){MochiKit.Style.setStyle(J.element,{opacity:H})}},E);var B=E.transition||D.Transitions.sinoidal;var G=C.bind(function(J){return B(1-D.Transitions.pulse(J,E.pulses))},B);C.bind(G,B);return new D.Opacity(I,C.update({transition:G},E))};MochiKit.Visual.fold=function(G,F){var H=MochiKit.DOM;var C=MochiKit.Visual;var E=MochiKit.Style;G=H.getElement(G);var D={top:G.style.top,left:G.style.left,width:G.style.width,height:G.style.height};var B=H.makeClipping(G);F=MochiKit.Base.update({scaleContent:false,scaleX:false,afterFinishInternal:function(I){new C.Scale(G,1,{scaleContent:false,scaleY:false,afterFinishInternal:function(J){E.hideElement(J.element);H.undoClipping(J.element,B);E.setStyle(J.element,D)}})}},F);return new C.Scale(G,5,F)};MochiKit.Visual.Color=MochiKit.Color.Color;MochiKit.Visual.getElementsComputedStyle=MochiKit.DOM.computedStyle;MochiKit.Visual.__new__=function(){var B=MochiKit.Base;B.nameFunctions(this);this.EXPORT_TAGS={":common":this.EXPORT,":all":B.concat(this.EXPORT,this.EXPORT_OK)}};MochiKit.Visual.EXPORT=["roundElement","roundClass","tagifyText","multiple","toggle","Parallel","Opacity","Move","Scale","Highlight","ScrollTo","Morph","fade","appear","puff","blindUp","blindDown","switchOff","dropOut","shake","slideDown","slideUp","squish","grow","shrink","pulsate","fold"];MochiKit.Visual.EXPORT_OK=["Base","PAIRS"];MochiKit.Visual.__new__();MochiKit.Base._exportSymbols(this,MochiKit.Visual);if(typeof (dojo)!="undefined"){dojo.provide("MochiKit.Selector");dojo.require("MochiKit.Base");dojo.require("MochiKit.DOM");dojo.require("MochiKit.Iter")}if(typeof (JSAN)!="undefined"){JSAN.use("MochiKit.Base",[]);JSAN.use("MochiKit.DOM",[]);JSAN.use("MochiKit.Iter",[])}try{if(typeof (MochiKit.Base)==="undefined"||typeof (MochiKit.DOM)==="undefined"||typeof (MochiKit.Iter)==="undefined"){throw""}}catch(e){throw"MochiKit.Selector depends on MochiKit.Base, MochiKit.DOM and MochiKit.Iter!"}if(typeof (MochiKit.Selector)=="undefined"){MochiKit.Selector={}}MochiKit.Selector.NAME="MochiKit.Selector";MochiKit.Selector.VERSION="1.4";MochiKit.Selector.__repr__=function(){return"["+this.NAME+" "+this.VERSION+"]"};MochiKit.Selector.toString=function(){return this.__repr__()};MochiKit.Selector.EXPORT=["Selector","findChildElements","findDocElements","$$"];MochiKit.Selector.EXPORT_OK=[];MochiKit.Selector.Selector=function(B){this.params={classNames:[],pseudoClassNames:[]};this.expression=B.toString().replace(/(^\s+|\s+$)/g,"");this.parseExpression();this.compileMatcher()};MochiKit.Selector.Selector.prototype={__class__:MochiKit.Selector.Selector,parseExpression:function(){function I(J){throw"Parse error in selector: "+J}if(this.expression==""){I("empty expression")}var C=MochiKit.Base.repr;var D=this.params;var F=this.expression;var B,H,G,E;while(B=F.match(/^(.*)\[([a-z0-9_:-]+?)(?:([~\|!^$*]?=)(?:"([^"]*)"|([^\]\s]*)))?\]$/i)){D.attributes=D.attributes||[];D.attributes.push({name:B[2],operator:B[3],value:B[4]||B[5]||""});F=B[1]}if(F=="*"){return this.params.wildcard=true}while(B=F.match(/^([^a-z0-9_-])?([a-z0-9_-]+(?:\([^)]*\))?)(.*)/i)){H=B[1];G=B[2];E=B[3];switch(H){case"#":D.id=G;break;case".":D.classNames.push(G);break;case":":D.pseudoClassNames.push(G);break;case"":case undefined:D.tagName=G.toUpperCase();break;default:I(C(F))}F=E}if(F.length>0){I(C(F))}},buildMatchExpression:function(){var H=MochiKit.Base.repr;var F=this.params;var D=[];var C,J;function M(N){return"MochiKit.Base.filter(function (node) { return node.nodeType == 1; }, "+N+".childNodes)"}if(F.wildcard){D.push("true")}if(C=F.id){D.push("element.id == "+H(C))}if(C=F.tagName){D.push("element.tagName.toUpperCase() == "+H(C))}if((C=F.classNames).length>0){for(J=0;J<C.length;J++){D.push("MochiKit.DOM.hasElementClass(element, "+H(C[J])+")")}}if((C=F.pseudoClassNames).length>0){for(J=0;J<C.length;J++){var I=C[J].match(/^([^(]+)(?:\((.*)\))?$/);var G=I[1];var E=I[2];switch(G){case"root":D.push("element.nodeType == 9 || element === element.ownerDocument.documentElement");break;case"nth-child":case"nth-last-child":case"nth-of-type":case"nth-last-of-type":I=E.match(/^((?:(\d+)n\+)?(\d+)|odd|even)$/);if(!I){throw"Invalid argument to pseudo element nth-child: "+E}var L,K;if(I[0]=="odd"){L=2;K=1}else{if(I[0]=="even"){L=2;K=0}else{L=I[2]&&parseInt(I)||null;K=parseInt(I[3])}}D.push("this.nthChild(element,"+L+","+K+","+!!G.match("^nth-last")+","+!!G.match("of-type$")+")");break;case"first-child":D.push("this.nthChild(element, null, 1)");break;case"last-child":D.push("this.nthChild(element, null, 1, true)");break;case"first-of-type":D.push("this.nthChild(element, null, 1, false, true)");break;case"last-of-type":D.push("this.nthChild(element, null, 1, true, true)");break;case"only-child":D.push(M("element.parentNode")+".length == 1");break;case"only-of-type":D.push("MochiKit.Base.filter(function (node) { return node.tagName == element.tagName; }, "+M("element.parentNode")+").length == 1");break;case"empty":D.push("element.childNodes.length == 0");break;case"enabled":D.push("(this.isUIElement(element) && element.disabled === false)");break;case"disabled":D.push("(this.isUIElement(element) && element.disabled === true)");break;case"checked":D.push("(this.isUIElement(element) && element.checked === true)");break;case"not":var B=new MochiKit.Selector.Selector(E);D.push("!( "+B.buildMatchExpression()+")");break}}}if(C=F.attributes){MochiKit.Base.map(function(P){var O="MochiKit.DOM.getNodeAttribute(element, "+H(P.name)+")";var N=function(Q){return O+".split("+H(Q)+")"};switch(P.operator){case"=":D.push(O+" == "+H(P.value));break;case"~=":D.push(O+" && MochiKit.Base.findValue("+N(" ")+", "+H(P.value)+") > -1");break;case"^=":D.push(O+".substring(0, "+P.value.length+") == "+H(P.value));break;case"$=":D.push(O+".substring("+O+".length - "+P.value.length+") == "+H(P.value));break;case"*=":D.push(O+".match("+H(P.value)+")");break;case"|=":D.push(O+" && "+N("-")+"[0].toUpperCase() == "+H(P.value.toUpperCase()));break;case"!=":D.push(O+" != "+H(P.value));break;case"":case undefined:D.push(O+" != null");break;default:throw"Unknown operator "+P.operator+" in selector"}},C)}return D.join(" && ")},compileMatcher:function(){this.match=new Function("element","if (!element.tagName) return false;                 return "+this.buildMatchExpression())},nthChild:function(G,C,B,E,H){var F=MochiKit.Base.filter(function(I){return I.nodeType==1},G.parentNode.childNodes);if(H){F=MochiKit.Base.filter(function(I){return I.tagName==G.tagName},F)}if(E){F=MochiKit.Iter.reversed(F)}if(C){var D=MochiKit.Base.findIdentical(F,G);return((D+1-B)/C)%1==0}else{return B==MochiKit.Base.findIdentical(F,G)+1}},isUIElement:function(B){return MochiKit.Base.findValue(["input","button","select","option","textarea","object"],B.tagName.toLowerCase())>-1},findElements:function(F,E){var D;if(E==undefined){E=""}function B(K,J){if(E==""){return MochiKit.DOM.isChildNode(K,J)}else{if(E==">"){return K.parentNode==J}else{if(E=="+"){return K==C(J)}else{if(E=="~"){var I=J;while(I=C(I)){if(K==I){return true}}return false}else{throw"Invalid axis: "+E}}}}}if(D=MochiKit.DOM.getElement(this.params.id)){if(this.match(D)){if(!F||B(D,F)){return[D]}}}function C(I){I=I.nextSibling;while(I&&I.nodeType!=1){I=I.nextSibling}return I}if(E==""){F=(F||MochiKit.DOM.currentDocument()).getElementsByTagName(this.params.tagName||"*")}else{if(E==">"){if(!F){throw"> combinator not allowed without preceeding expression"}F=MochiKit.Base.filter(function(I){return I.nodeType==1},F.childNodes)}else{if(E=="+"){if(!F){throw"+ combinator not allowed without preceeding expression"}F=C(F)&&[C(F)]}else{if(E=="~"){if(!F){throw"~ combinator not allowed without preceeding expression"}var H=[];while(C(F)){F=C(F);H.push(F)}F=H}}}}if(!F){return[]}var G=MochiKit.Base.filter(MochiKit.Base.bind(function(I){return this.match(I)},this),F);return G},repr:function(){return"Selector("+this.expression+")"},toString:MochiKit.Base.forwardCall("repr")};MochiKit.Base.update(MochiKit.Selector,{findChildElements:function(B,C){return MochiKit.Base.flattenArray(MochiKit.Base.map(function(E){var D="";return MochiKit.Iter.reduce(function(H,I){if(match=I.match(/^[>+~]$/)){D=match[0];return H}else{var G=new MochiKit.Selector.Selector(I);var F=MochiKit.Iter.reduce(function(K,J){return MochiKit.Base.extend(K,G.findElements(J||B,D))},H,[]);D="";return F}},E.replace(/(^\s+|\s+$)/g,"").split(/\s+/),[null])},C))},findDocElements:function(){return MochiKit.Selector.findChildElements(MochiKit.DOM.currentDocument(),arguments)},__new__:function(){var B=MochiKit.Base;this.$$=this.findDocElements;this.EXPORT_TAGS={":common":this.EXPORT,":all":B.concat(this.EXPORT,this.EXPORT_OK)};B.nameFunctions(this)}});MochiKit.Selector.__new__();MochiKit.Base._exportSymbols(this,MochiKit.Selector);if(typeof (dojo)!="undefined"){dojo.provide("MochiKit.Async");dojo.require("MochiKit.Base")}if(typeof (JSAN)!="undefined"){JSAN.use("MochiKit.Base",[])}try{if(typeof (MochiKit.Base)=="undefined"){throw""}}catch(e){throw"MochiKit.Async depends on MochiKit.Base!"}if(typeof (MochiKit.Async)=="undefined"){MochiKit.Async={}}MochiKit.Async.NAME="MochiKit.Async";MochiKit.Async.VERSION="1.4";MochiKit.Async.__repr__=function(){return"["+this.NAME+" "+this.VERSION+"]"};MochiKit.Async.toString=function(){return this.__repr__()};MochiKit.Async.Deferred=function(B){this.chain=[];this.id=this._nextId();this.fired=-1;this.paused=0;this.results=[null,null];this.canceller=B;this.silentlyCancelled=false;this.chained=false};MochiKit.Async.Deferred.prototype={repr:function(){var B;if(this.fired==-1){B="unfired"}else{if(this.fired===0){B="success"}else{B="error"}}return"Deferred("+this.id+", "+B+")"},toString:MochiKit.Base.forwardCall("repr"),_nextId:MochiKit.Base.counter(),cancel:function(){var B=MochiKit.Async;if(this.fired==-1){if(this.canceller){this.canceller(this)}else{this.silentlyCancelled=true}if(this.fired==-1){this.errback(new B.CancelledError(this))}}else{if((this.fired===0)&&(this.results[0] instanceof B.Deferred)){this.results[0].cancel()}}},_resback:function(B){this.fired=((B instanceof Error)?1:0);this.results[this.fired]=B;this._fire()},_check:function(){if(this.fired!=-1){if(!this.silentlyCancelled){throw new MochiKit.Async.AlreadyCalledError(this)}this.silentlyCancelled=false;return }},callback:function(B){this._check();if(B instanceof MochiKit.Async.Deferred){throw new Error("Deferred instances can only be chained if they are the result of a callback")}this._resback(B)},errback:function(C){this._check();var B=MochiKit.Async;if(C instanceof B.Deferred){throw new Error("Deferred instances can only be chained if they are the result of a callback")}if(!(C instanceof Error)){C=new B.GenericError(C)}this._resback(C)},addBoth:function(B){if(arguments.length>1){B=MochiKit.Base.partial.apply(null,arguments)}return this.addCallbacks(B,B)},addCallback:function(B){if(arguments.length>1){B=MochiKit.Base.partial.apply(null,arguments)}return this.addCallbacks(B,null)},addErrback:function(B){if(arguments.length>1){B=MochiKit.Base.partial.apply(null,arguments)}return this.addCallbacks(null,B)},addCallbacks:function(B,C){if(this.chained){throw new Error("Chained Deferreds can not be re-used")}this.chain.push([B,C]);if(this.fired>=0){this._fire()}return this},_fire:function(){var H=this.chain;var G=this.fired;var D=this.results[G];var C=this;var B=null;while(H.length>0&&this.paused===0){var I=H.shift();var F=I[G];if(F===null){continue}try{D=F(D);G=((D instanceof Error)?1:0);if(D instanceof MochiKit.Async.Deferred){B=function(J){C._resback(J);C.paused--;if((C.paused===0)&&(C.fired>=0)){C._fire()}};this.paused++}}catch(E){G=1;if(!(E instanceof Error)){E=new MochiKit.Async.GenericError(E)}D=E}}this.fired=G;this.results[G]=D;if(B&&this.paused){D.addBoth(B);D.chained=true}}};MochiKit.Base.update(MochiKit.Async,{evalJSONRequest:function(B){return MochiKit.Base.evalJSON(B.responseText)},succeed:function(B){var C=new MochiKit.Async.Deferred();C.callback.apply(C,arguments);return C},fail:function(B){var C=new MochiKit.Async.Deferred();C.errback.apply(C,arguments);return C},getXMLHttpRequest:function(){var B=arguments.callee;if(!B.XMLHttpRequest){var F=[function(){return new XMLHttpRequest()},function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Microsoft.XMLHTTP")},function(){return new ActiveXObject("Msxml2.XMLHTTP.4.0")},function(){throw new MochiKit.Async.BrowserComplianceError("Browser does not support XMLHttpRequest")}];for(var C=0;C<F.length;C++){var D=F[C];try{B.XMLHttpRequest=D;return D()}catch(E){}}}return B.XMLHttpRequest()},_xhr_onreadystatechange:function(F){var B=MochiKit.Base;if(this.readyState==4){try{this.onreadystatechange=null}catch(E){try{this.onreadystatechange=B.noop}catch(E){}}var C=null;try{C=this.status;if(!C&&B.isNotEmpty(this.responseText)){C=304}}catch(E){}if(C==200||C==201||C==204||C==304||C==1223){F.callback(this)}else{var D=new MochiKit.Async.XMLHttpRequestError(this,"Request failed");if(D.number){F.errback(D)}else{F.errback(D)}}}},_xhr_canceller:function(B){try{B.onreadystatechange=null}catch(C){try{B.onreadystatechange=MochiKit.Base.noop}catch(C){}}B.abort()},sendXMLHttpRequest:function(D,H){if(typeof (H)=="undefined"||H===null){H=""}var B=MochiKit.Base;var C=MochiKit.Async;var F=new C.Deferred(B.partial(C._xhr_canceller,D));try{D.onreadystatechange=B.bind(C._xhr_onreadystatechange,D,F);D.send(H)}catch(E){try{D.onreadystatechange=null}catch(G){}F.errback(E)}return F},doXHR:function(C,D){var B=MochiKit.Async;return B.callLater(0,B._doXHR,C,D)},_doXHR:function(D,B){var E=MochiKit.Base;B=E.update({method:"GET",sendContent:""},B);var L=MochiKit.Async;var K=L.getXMLHttpRequest();if(B.queryString){var J=E.queryString(B.queryString);if(J){D+="?"+J}}if("username" in B){K.open(B.method,D,true,B.username,B.password)}else{K.open(B.method,D,true)}if(K.overrideMimeType&&B.mimeType){K.overrideMimeType(B.mimeType)}K.setRequestHeader("X-Requested-With","XMLHttpRequest");if(B.headers){var H=B.headers;if(!E.isArrayLike(H)){H=E.items(H)}for(var F=0;F<H.length;F++){var G=H[F];var C=G[0];var I=G[1];K.setRequestHeader(C,I)}}return L.sendXMLHttpRequest(K,B.sendContent)},_buildURL:function(D){if(arguments.length>1){var C=MochiKit.Base;var B=C.queryString.apply(null,C.extend(null,arguments,1));if(B){return D+"?"+B}}return D},doSimpleXMLHttpRequest:function(C){var B=MochiKit.Async;C=B._buildURL.apply(B,arguments);return B.doXHR(C)},loadJSONDoc:function(C){var B=MochiKit.Async;C=B._buildURL.apply(B,arguments);var D=B.doXHR(C,{mimeType:"text/plain",headers:[["Accept","application/json"]]});D=D.addCallback(B.evalJSONRequest);return D},wait:function(F,D){var E=new MochiKit.Async.Deferred();var B=MochiKit.Base;if(typeof (D)!="undefined"){E.addCallback(function(){return D})}var C=setTimeout(B.bind("callback",E),Math.floor(F*1000));E.canceller=function(){try{clearTimeout(C)}catch(G){}};return E},callLater:function(C,E){var B=MochiKit.Base;var D=B.partial.apply(B,B.extend(null,arguments,1));return MochiKit.Async.wait(C).addCallback(function(F){return D()})}});MochiKit.Async.DeferredLock=function(){this.waiting=[];this.locked=false;this.id=this._nextId()};MochiKit.Async.DeferredLock.prototype={__class__:MochiKit.Async.DeferredLock,acquire:function(){var B=new MochiKit.Async.Deferred();if(this.locked){this.waiting.push(B)}else{this.locked=true;B.callback(this)}return B},release:function(){if(!this.locked){throw TypeError("Tried to release an unlocked DeferredLock")}this.locked=false;if(this.waiting.length>0){this.locked=true;this.waiting.shift().callback(this)}},_nextId:MochiKit.Base.counter(),repr:function(){var B;if(this.locked){B="locked, "+this.waiting.length+" waiting"}else{B="unlocked"}return"DeferredLock("+this.id+", "+B+")"},toString:MochiKit.Base.forwardCall("repr")};MochiKit.Async.DeferredList=function(G,D,C,B,J){MochiKit.Async.Deferred.apply(this,[J]);this.list=G;var I=[];this.resultList=I;this.finishedCount=0;this.fireOnOneCallback=D;this.fireOnOneErrback=C;this.consumeErrors=B;var E=MochiKit.Base.bind(this._cbDeferred,this);for(var F=0;F<G.length;F++){var H=G[F];I.push(undefined);H.addCallback(E,F,true);H.addErrback(E,F,false)}if(G.length===0&&!D){this.callback(this.resultList)}};MochiKit.Async.DeferredList.prototype=new MochiKit.Async.Deferred();MochiKit.Async.DeferredList.prototype._cbDeferred=function(C,B,D){this.resultList[C]=[B,D];this.finishedCount+=1;if(this.fired==-1){if(B&&this.fireOnOneCallback){this.callback([C,D])}else{if(!B&&this.fireOnOneErrback){this.errback(D)}else{if(this.finishedCount==this.list.length){this.callback(this.resultList)}}}}if(!B&&this.consumeErrors){D=null}return D};MochiKit.Async.gatherResults=function(B){var C=new MochiKit.Async.DeferredList(B,false,true,false);C.addCallback(function(F){var D=[];for(var E=0;E<F.length;E++){D.push(F[E][1])}return D});return C};MochiKit.Async.maybeDeferred=function(E){var B=MochiKit.Async;var C;try{var D=E.apply(null,MochiKit.Base.extend([],arguments,1));if(D instanceof B.Deferred){C=D}else{if(D instanceof Error){C=B.fail(D)}else{C=B.succeed(D)}}}catch(F){C=B.fail(F)}return C};MochiKit.Async.EXPORT=["AlreadyCalledError","CancelledError","BrowserComplianceError","GenericError","XMLHttpRequestError","Deferred","succeed","fail","getXMLHttpRequest","doSimpleXMLHttpRequest","loadJSONDoc","wait","callLater","sendXMLHttpRequest","DeferredLock","DeferredList","gatherResults","maybeDeferred","doXHR"];MochiKit.Async.EXPORT_OK=["evalJSONRequest"];MochiKit.Async.__new__=function(){var B=MochiKit.Base;var C=B.partial(B._newNamedError,this);C("AlreadyCalledError",function(D){this.deferred=D});C("CancelledError",function(D){this.deferred=D});C("BrowserComplianceError",function(D){this.message=D});C("GenericError",function(D){this.message=D});C("XMLHttpRequestError",function(D,F){this.req=D;this.message=F;try{this.number=D.status}catch(E){}});this.EXPORT_TAGS={":common":this.EXPORT,":all":B.concat(this.EXPORT,this.EXPORT_OK)};B.nameFunctions(this)};MochiKit.Async.__new__();MochiKit.Base._exportSymbols(this,MochiKit.Async);var enableLog=true;window.log=function(B){try{if(enableLog){if(window.console&&window.console.log){window.console.log(B)}else{if(window.external){window.external.info(B)}else{if(logDebug){logDebug(B)}}}}}catch(C){enableLog=false}};function el(B){return document.getElementById(B)}function hide(){for(i=0;i<arguments.length;++i){var C=arguments[i];var B=document.getElementById(C);if(B){B.style.display="none"}}}function show(){for(i=0;i<arguments.length;++i){var C=arguments[i];var B=document.getElementById(C);if(B){B.style.display="block"}}}function findPosX(B){var C=0;if(B.offsetParent){while(B.offsetParent){C+=B.offsetLeft;B=B.offsetParent}}else{if(B.x){C+=B.x}}return C}function findPosY(C){var B=0;if(C.offsetParent){while(C.offsetParent){B+=C.offsetTop;C=C.offsetParent}}else{if(C.y){B+=C.y}}return B}function cancelEventBubble(B){if(B.stopPropagation){B.stopPropagation()}else{B.cancelBubble=true}if(B.preventDefault){B.preventDefault()}else{B.returnValue=false}}function funcname(D){var B=D.toString().match(/function (\w*)/);if(B&&(B.length>0)){var C=B[1];if((C==null)||(C.length==0)){return"anonymous"}return C}else{return"anonymous"}}function stacktrace(){var C="";for(var B=arguments.caller;B!=null;B=B.caller){C+="->"+funcname(B.callee)+"\n";if(B.caller==B){C+="*";break}}return C}function setCookie(C,E,B,G,D,F){document.cookie=C+"="+escape(E)+((B)?"; expires="+B.toGMTString():"")+((G)?"; path="+G:"")+((D)?"; domain="+D:"")+((F)?"; secure":"")}function getCookie(D){var C=document.cookie;var F=D+"=";var E=C.indexOf("; "+F);if(E==-1){E=C.indexOf(F);if(E!=0){return null}}else{E+=2}var B=document.cookie.indexOf(";",E);if(B==-1){B=C.length}return unescape(C.substring(E+F.length,B))}function int2Hex(C){var D=C%16;var B=(C-D)/16;return hexChar(B)+""+hexChar(D)}function hexChar(B){if(B==10){return"a"}else{if(B==11){return"b"}else{if(B==12){return"c"}else{if(B==13){return"d"}else{if(B==14){return"e"}else{if(B==15){return"f"}else{return parseInt(B)}}}}}}}function hex2Int(B){if(B=="a"){return 10}if(B=="b"){return 11}if(B=="c"){return 12}if(B=="d"){return 13}if(B=="e"){return 14}if(B=="f"){return 15}return parseInt(B)}var colorKeyItem=null;function hotColor(B){colorKeyItem=B;window.document.body.onkeydown=handleColorKey}function handleColorKey(G){if(!colorKeyItem){return }if(!G){G=window.event}var I=document.layers?G.which:document.all?G.keyCode:document.getElementById?G.keyCode:0;var C=colorKeyItem;var H=computedStyle(C,"backgroundColor","background-color");if(H==null||H==""){H="#6988bb"}var F=hex2Int(H.charAt(1))*16+hex2Int(H.charAt(2));var E=hex2Int(H.charAt(3))*16+hex2Int(H.charAt(4));var B=hex2Int(H.charAt(5))*16+hex2Int(H.charAt(6));log(H+" r="+F+" g="+E+" b="+B+" key="+I);if(I==82){F+=2;if(F>255){F=0}var D="#"+int2Hex(F)+int2Hex(E)+int2Hex(B);log("new color is "+D);C.style.backgroundColor=D}else{if(I==71){E+=2;if(E>255){E=0}var D="#"+int2Hex(F)+int2Hex(E)+int2Hex(B);log("new color is "+D);C.style.backgroundColor=D}else{if(I==66){B+=2;if(B>255){B=0}var D="#"+int2Hex(F)+int2Hex(E)+int2Hex(B);log("new color is "+D);C.style.backgroundColor=D}}}}function trim(B){return B.replace(/^\s+/g,"").replace(/\s+$/g,"")}var currentDragHandler;function DragHandler(C,B){log("Starting drag handler");if(!B){B=window.document}currentDragHandler=this;if(B.addEventListener){B.addEventListener("mousemove",DragMoveHandler,true);B.addEventListener("mouseup",DragUpHandler,true)}else{if(B.attachEvent){B.attachEvent("onmousemove",DragMoveHandler);B.attachEvent("onmouseup",DragUpHandler)}}if(C){cancelEventBubble(C)}}function DragMoveHandler(B){if(!B){B=window.event}currentDragHandler.handleMove(B);cancelEventBubble(B)}function DragUpHandler(B){if(!B){B=window.event}if(document.removeEventListener){document.removeEventListener("mouseup",DragUpHandler,true);document.removeEventListener("mousemove",DragMoveHandler,true)}else{if(document.detachEvent){document.detachEvent("onmouseup",DragUpHandler);document.detachEvent("onmousemove",DragMoveHandler)}}currentDragHandler.handleUp(B);cancelEventBubble(B)}DragHandler.prototype.handleUp=function(B){};DragHandler.prototype.handleMove=function(B){};function getRule(D,B){for(j=0;j<document.styleSheets.length;j++){var C=document.styleSheets[j];if(C.href.lastIndexOf(D)==(C.href.length-D.length)){var E=C.rules||C.cssRules;for(i=E.length-1;i>=0;i--){if(E[i].selectorText==B){return E[i]}}log("WARN: Exhausted rules search");break}}}function dumpProperties(C,E){if(E==null){alert("Dumping properties "+C+": null object")}else{var D="Dumping properties ";D+=C;D+="\n";for(var B in E){D+=B;D+=":";D+=E[B];D+="\n"}alert(D)}}function formatDateOfBirth(B){var C=(B.getMonth()+1)+"/"+B.getDate()+"/"+(B.getFullYear());return(C)}function formatLocalDateTime(B){var D=formatDateOfBirth(B);D+=" ";var C=numberFormatter("00");D+=C(B.getHours())+":"+C(B.getMinutes());if(B.getHours()<12){D+=" AM"}else{D+=" PM"}return(D)}function genericErrorHandler(B){alert("An error occurred while performing last operation.\r\n\r\nError: "+B.message+"\r\n\r\nCode: "+B.number+"\r\n\r\nTry the operation again or contact support for help.");window.lastError=B}function prettyAccId(B){return B.replace(/([0-9]{4})([0-9]{4})([0-9]{4})([0-9]{4})/,"$1 $2 $3 $4")}function execJSONRequest(url,postdata,success){var req=getXMLHttpRequest();if(postdata){log("Opening request "+url);req.open("POST",url,true);log("Opened post request");log("sending with post data: "+postdata);req.setRequestHeader("Content-Type","application/x-www-form-urlencoded")}else{req.open("GET",url,true)}sendXMLHttpRequest(req,postdata).addCallbacks(function(req){log("got result "+req.responseText);try{var js=(eval("var x="+req.responseText+"; x;"))}catch(e){dumpProperties("Error while evaluating returned result",e);log("Error while evaluating returned result: "+req.responseText);return }success(js)},genericErrorHandler)}var ce_events=new Object();ce_events.id=Math.floor(Math.random()*100000);var ce_last_event_src=null;var ce_timer=null;var ce_src_id=(new Date().getTime()+""+Math.floor(Math.random()*100000)).substring(6);var ce_known_windows=new Array();var MAX_CE_AGE=4000;var ce_begin_time=(new Date()).getTime();var ce_is_loaded=false;var ce_history=new Array();function ce_connect(C,D,B){connect(ce_events,C,D,B);ce_init()}function ce_connect_src(E,C,D,B){ce_init();connect(ce_known_windows[E],C,D,B)}function ce_init_timer(){if(ce_timer==null){ce_known_windows[ce_src_id]=new Object();ce_timer=setInterval(ce_poll,1000)}}function ce_init(){if(ce_is_loaded){ce_init_timer()}else{addLoadEvent(ce_init_timer)}}function ce_loaded(){ce_is_loaded=true}if(window.addLoadEvent){addLoadEvent(ce_loaded)}var ce_old_ce=getCookie("ce");if(!ce_old_ce){ce_old_ce=""}function is_old_ce(D){var C=parseInt(D,10);var B=(new Date()).getTime();if(C<(B-MAX_CE_AGE)){return true}if(C<ce_begin_time){return true}if(findValue(ce_history,D)!=-1){return true}return false}function ce_add_history(D){ce_history.push(D);var B=(new Date()).getTime()-MAX_CE_AGE;var C=0;while((C<ce_history.length)&&(parseInt(ce_history[C],10)<B)){++C}if(C>0){ce_history.splice(0,C)}}function ce_poll(){var B=getCookie("ce");if((B==null)||(B==ce_old_ce)){return }ce_old_ce=B;var C=B!=null?B.split(/;/):new Array();forEach(C,function(G){if(is_old_ce(G)){return }ce_add_history(G);var D=G.split(/:/);var H=D[0].split(/,/);var F=H[0];ce_last_event_src=null;if((H.length>1)&&(H[1]!=undefined)){ce_last_event_src=H[1];if(ce_known_windows[ce_last_event_src]==undefined){ce_known_windows[ce_last_event_src]=new Object()}}if(ce_src_id!=ce_last_event_src){log("["+window.name+"] Received event "+D[1]+" at time "+F+" from src: "+ce_last_event_src)}var E=D[1]?map(unescape,D[1].split(",")):new Array();E.unshift(ce_events);signal.apply(this,E);if(ce_last_event_src){E.shift();E.unshift(ce_known_windows[ce_last_event_src]);signal.apply(this,E)}})}function ce_signal(F){ce_poll();var I=new Array();for(var E=0;E<arguments.length;++E){I.push(urlEncode(arguments[E]))}var G=getCookie("ce");var D=G!=null?G.split(/;/):new Array();var B=(new Date()).getTime();var J=new Array();forEach(D,function(L){var K=parseInt(L);if(K>(B-MAX_CE_AGE)){J.push(L)}});J.push(B+","+ce_src_id+":"+I.join(","));var H=J.join(";");while(H.length>1500){var C=H.indexOf(";");if(C>=0){H=H.substring(C+1);log("WARN: ce overflow, abandoned "+C+" characters")}else{break}}ce_old_ce=H;setCookie("ce",H,null,"/");forEach(ce_servers,function(L){var N=document.getElementsByTagName("head").item(0);var K=document.createElement("script");K.setAttribute("type","text/javascript");var M=L+"?e="+urlEncode(H);log("sending signal to server: "+M);K.setAttribute("src",M);N.appendChild(K)})}var ce_servers=new Array();function ce_add_server(B){if(findValue(ce_servers,B)<0){ce_servers.push(B)}}var broadCasting=false;function addHeightMonitor(){log("Adding height monitor in window "+window.name);document.body.onresize=broadCastHeight;broadCastHeight();broadCasting=true}function _calculateHeight(){if(document.body.scrollHeight>document.body.offsetHeight){h=document.body.scrollHeight}else{h=document.body.offsetHeight}if(!document.all&&(h<document.body.parentNode.offsetHeight)){h=document.body.parentNode.offsetHeight}return h}var bc_last_height=0;function broadCastHeight(){var B=0;if(window.calculateHeight){B=calculateHeight()}else{B=_calculateHeight()}if(B!=bc_last_height){log("Calculated window "+window.name+" has height "+B);ce_signal("windowResized",window.name,B);bc_last_height=B}}function addHeightSync(){ce_connect("windowResized",adjustFrameHeight)}function adjustFrameHeight(D,B){var C=null;forEach(document.getElementsByTagName("iframe"),function(E){if(E.name==D){C=E}});if(!C){log("["+window.name+"] size reported for unknown child frame "+D+" : ignoring.");return }if(C.height!=B){log("sizing ["+D+"] to "+B);C.height=B;C.style.height=B+"px"}signal(ce_events,"ce_resized",C,B);if(broadCasting){broadCastHeight()}}var yuiListeners=[];var yui_loader_is_loading=false;function yuiLoader(E){if(window.YUI_initialized){return{insert:function(F){F()}}}var D={insert:function(F){yuiListeners.push(F)}};if((typeof YAHOO=="undefined")||!YAHOO.util||!YAHOO.util.YUILoader){if(yui_loader_is_loading){log("yui still loading ...");return }yui_loader_is_loading=true;var C=document.getElementsByTagName("head").item(0);var B=document.createElement("script");B.setAttribute("type","text/javascript");log("loading yui loader ... ");B.setAttribute("src","/yui/2.6.0/yuiloader/yuiloader-min.js");C.appendChild(B);window.setInterval(yuiLoader,100);return D}yui_loader_is_loading=false;if(!E){E=["connection","utilities","button","container","datasource","json"]}window.loader=new YAHOO.util.YUILoader({require:E,loadOptional:true,onSuccess:function(){log("YUI load complete");if(!window.YUI_initialized){window.YUI_initialized=true;log("YUI loaded.  Signalling "+yuiListeners.length+" waiting components.");for(var F=0;F<yuiListeners.length;++F){log("Signalling function "+yuiListeners[F]);yuiListeners[F].apply(window)}}}});loader.insert({base:"/yui/2.6.0/"});return D}var auto_complete_show_options={select_value:auto_complete_highlight_line,show_all:false,fill_value:auto_complete_fill_value,offsetX:50,offsetY:14,auto_show:true};var auto_complete_show_match_only={select_value:write_inner_html,show_all:false,fill_value:auto_complete_fill_value,offsetX:50,offsetY:14,auto_show:true};var auto_complete_default_message="Press Enter or Click to select entry";var autocompleteBehavior=auto_complete_show_options;autocompleteBehavior.message=auto_complete_default_message;var auto_complete_default_behavior=new Object();for(i in autocompleteBehavior){auto_complete_default_behavior[i]=autocompleteBehavior[i]}var currentCompletion=-1;var autocompleteField=null;function init_autocomplete(C,B){C.values=B;C.onkeyup=autocomplete;C.onkeydown=auto_complete_key_down;C.setAttribute("autocomplete","off");C.autocomplete=autocomplete}function auto_complete_key_down(B){if(!B){B=window.event}autocomplete_taboff(B);if(this.originalValue==null){this.originalValue=this.value}if(B.keyCode==13){auto_complete_cancel_evt(B)}}function autocomplete(D){if(!D){D=window.event}var G=D?D.keyCode:0;field=this;var H=document.getElementById("acdiv");if(field.autocompleteBehavior&&!field.autocompleteBehavior.auto_show){if(G>0){if(H.style.display!="block"){return }}}if(field.autocompleteBehavior){autocompleteBehavior=field.autocompleteBehavior}var E=field.value;autocompleteField=field;if(E==""){if(!autocompleteBehavior.show_all){H.style.display="none";return }}if(G==16){}else{if(G==27){auto_complete_reset_field(field)}else{if(G==9){}else{if(G==13){autocompleteBehavior.fill_value(currentCompletion);auto_complete_cancel_evt(D)}else{if(G==40){currentCompletion++;if(currentCompletion>=field.values.length){currentCompletion=0}autocompleteBehavior.select_value(currentCompletion);return }else{if(G==38){currentCompletion--;if(currentCompletion<0){currentCompletion=field.values.length-1}autocompleteBehavior.select_value(currentCompletion);return }else{log("displaying ac 1");var C=new RegExp("^"+E,"i");var F=false;for(i=0;i<field.values.length;++i){if(C.test(field.values[i])){F=true;currentCompletion=i;autocompleteBehavior.select_value(i);break}}log("displaying ac found="+F);if(!autocompleteBehavior.show_all&&!F){H.innerHTML=E;currentCompletion=-1}else{if(!F){autocompleteBehavior.select_value(-1)}var B=findPosX(field);var I=findPosY(field);H.style.display="block";H.style.left=(B+autocompleteBehavior.offsetX)+"px";H.style.top=(I+autocompleteBehavior.offsetY)+"px"}}}}}}}}function auto_complete_fill_value(B){var C=autocompleteField;if(C==null){return }C.value=C.values[B];C.originalValue=C.value;document.getElementById("acdiv").style.display="none"}function auto_complete_highlight_line(D){var B=autocompleteField.values;var C="";for(j=0;j<B.length;++j){if(D==j){C+='<div class="achighlight"><a href="#" onclick="autocompleteBehavior.fill_value('+j+'); return false;" class="achighlight">'+B[j]+"</a></div>"}else{C+='<div><a href="#" onclick="javascript:autocompleteBehavior.fill_value('+j+'); return false;">'+B[j]+"</a></div>"}}C+='<div id="acinstr">'+autocompleteBehavior.message+"</div>";var E=document.getElementById("acdiv");E.innerHTML=C}function write_inner_html(B){var C=document.getElementById("acdiv");C.innerHTML=autocompleteField.values[B]}function auto_complete_inline_select(E){var D=autocompleteField;if(!D){return }var B=D.value;D.value=E;var C=D.createTextRange();C.moveStart("character",B.length);C.select()}function auto_complete_reset_field(B){var C=document.getElementById("acdiv");if(B){if(B.originalValue){B.value=B.originalValue}B.originalValue=null;autocompleteField=null;B.select()}C.style.display="none"}function autocomplete_taboff(B){if(!B){B=window.event}if(B.keyCode==9){log("currentCompletion = "+currentCompletion);if(autocompleteField&&(currentCompletion>=0)){autocompleteField.value=autocompleteField.values[currentCompletion];var C=document.getElementById("acdiv");C.style.display="none";currentCompletion=-1;autocompleteField=null}}}function auto_complete_cancel_evt(B){if(B.stopPropagation){B.stopPropagation()}else{B.cancelBubble=true}if(B.preventDefault){B.preventDefault()}else{B.returnValue=false}}function auto_complete_reset_behavior(){autocompleteBehavior=new Object();for(i in auto_complete_default_behavior){autocompleteBehavior[i]=auto_complete_default_behavior[i]}}var RLSParams={pid:null,page:1,showHidden:false};function page(B){RLSParams.page=B;refreshRLS()}function toggleShowHiddenPatients(){RLSParams.showHidden=!RLSParams.showHidden;refreshRLS()}function updateSearch(){if(window.searchTimeout){window.clearTimeout(window.searchTimeout)}RLSParams.page=1;window.searchTimeout=window.setTimeout(refreshRLS,600)}function clearRLSSearch(){clearSearch("registryTable");refreshRLS()}function clearSearch(B){forEach($$("#"+B+" input"),function(C){C.value=""});forEach($$("#"+B+" select"),function(C){C.selectedIndex=0})}function refreshRLS(){refreshTable("rls","rls.php?"+queryString($$("#registryTable tr.searchRow")[0])+"&lt=2&"+queryString(RLSParams))}function refreshTable(B,C){doSimpleXMLHttpRequest(C).addCallbacks(function(E){$(B+"Parser").innerHTML=E.responseText;var D=[];forEach($(B+"Rows").getElementsByTagName("tr"),function(F){D.push(F)});forEach(D,removeElement);forEach($$("#"+B+"Parser tr"),function(F){removeElement(F);appendChildNodes($(B+"Rows"),F)});broadCastHeight()},genericErrorHandler)}function unhidePatient(B,C){execJSONRequest("unhidePatient.php",authQueryString({patientId:B}),function(D){if(D.status=="ok"){refreshRLS();if(C){C()}}else{alert("There was a problem restoring this Patient:\r\n\r\n"+D.error)}})}function hidePatient(B){execJSONRequest("hidePatient.php",authQueryString({patientId:B}),function(C){if(C.status=="ok"){removeElement($("row_"+B))}else{alert("There was a problem hiding this Patient:\r\n\r\n"+C.error)}})}function switchToPatientMode(){setAccessMode("patient");document.location="home.php"}function setAccessMode(B){if(B=="patient"){setCookie("mode","p",null,"/")}else{setCookie("mode","g",null,"/")}}function isPatientModeSet(){return getCookie("mode")=="p"}function parentSize(){try{if(window.parent&&window.parent.sizecontent){window.parent.sizecontent()}}catch(B){}}var statusValues=[];var currentStatusField=null;function editStatus(F){var D=$("sTxt"+F);D.cc=F;init_autocomplete(D,statusValues);var C=clone(autocompleteBehavior);C.show_all=true;C.fill_value=statusSelect;C.offsetX=-34;C.offsetY=20;C.message="Click on a Status to select it &nbsp;&nbsp;<img src='images/closebutton.gif' style='margin-top:4px; cursor: pointer;' onclick='statusSelect(-1)'/>";C.auto_show=false;D.autocompleteBehavior=C;currentStatusField=D;D.autocomplete();var B=(elementDimensions($("acdiv")).h+elementDimensions($("records")).h-40);$("records").style.height=B+"px";try{if(window.parent.adjustFrameHeight){window.parent.adjustFrameHeight(window.name,B)}}catch(E){}broadCastHeight()}function statusSelect(C){if(C>=0){var D=currentStatusField;var F=statusValues[C];var B="ws/wsUpdateStatus.php?cc="+D.cc+"&status="+F+"&pid="+practiceId;loadJSONDoc(B).addCallbacks(saveStatusSuccess,genericErrorHandler)}else{var E=$("acdiv");E.style.display="none";$("records").style.height="auto";auto_complete_reset_behavior()}}function saveStatusSuccess(B){var C=currentStatusField;currentStatusField=null;var D=$("acdiv");D.style.display="none";$("records").style.height="auto";auto_complete_reset_behavior();if(B.status=="ok"){C.originalValue=B.savedStatus;C.value=B.savedStatus;refreshRLS()}else{alert("Saving status failed: \r\n\r\n"+B.message)}}function over(B){if(statuses[B]&&(statuses[B]!="")){$("r"+B).style.color="orange";$("sImg"+B).style.visibility="visible";$("sImg"+B).style.display="inline"}}function out(B){$("r"+B).style.color="black";$("sImg"+B).style.visibility="hidden"}var statuses=new Array();function highlight(B){if(B.getAttribute("readonly")){return }if(B.select!=null){B.select()}B.onblur=unhighlight;B.style.backgroundColor="#e6e6e6"}function unhighlight(){this.style.backgroundColor="#f3f3f3";if(this.oldBackgroundColor){this.style.backgroundColor=this.oldBackgroundColor}}function showtime(E,D){var C=E.getHours();var F=E.getMinutes();var H=E.getSeconds();var B="pm";if(C<12){B="am"}if(C>12){C=C-12}if(C==0){C=12}if(F<=9){F="0"+F}if(H<=9){H="0"+H}var G=C+":"+F+":"+H+" "+B;return"<b style='color:"+D+"'>"+G+"</b>"}function addInterest(){var C=$("interestsTable");var B=C.getElementsByTagName("tbody")[0];appendChildNodes(B,TR(null,TD(null,$("newInterest").value),TD(null,A({href:"javascript:;",onclick:"interestUp(this);"},IMG({src:"../images/black_arrow_up.gif"})),A({href:"javascript:;",onclick:"interestDown(this);"},IMG({src:"../images/black_arrow_down.gif"})),A({href:"javascript:;",onclick:"removeInterest(this);"},IMG({src:"../images/cross.jpg"})))));saveInterests()}function interestUp(B){var G=$("interestsTable");var F=G.getElementsByTagName("tbody")[0];var I=B.parentNode;var E=I.parentNode;var D=null;for(var C=0;C<F.childNodes.length;++C){var H=F.childNodes[C];if(H==E){if(D){removeElement(E);F.insertBefore(E,D);break}}D=H}saveInterests()}function interestDown(I){var E=$("interestsTable");var G=E.getElementsByTagName("tbody")[0];var C=I.parentNode;var H=C.parentNode;var D=null;for(var F=0;F<G.childNodes.length;++F){var B=G.childNodes[F];if(B==H){if(F<G.childNodes.length-2){var J=G.childNodes[F+2];removeElement(H);G.insertBefore(H,J);break}else{removeElement(H);appendChildNodes(G,H)}}}saveInterests()}function removeInterest(B){var G=$("interestsTable");var F=G.getElementsByTagName("tbody")[0];var I=B.parentNode;var E=I.parentNode;var D=null;for(var C=0;C<F.childNodes.length;++C){var H=F.childNodes[C];if(H==E){removeElement(E)}}saveInterests()}function saveInterests(){var C=$("interestsTable");var B=C.getElementsByTagName("tbody")[0];var D="";forEach(B.childNodes,function(E){if(E.getElementsByTagName){if(D!=""){D+="|"}D+=scrapeText(E.getElementsByTagName("td")[0])}});loadJSONDoc("../saveInterests.php?interests="+escape(D)).addCallbacks(function(E){log("interests saved")},genericErrorHandler)}function checkCurrentPatient(D,H,F,B,E,C){var G=getCookie("mcgw");if(D){$("hippaPatientId").value=prettyAccId(D);document.coverForm.coverNotifyEmail.value=C;log("setting new patient id "+D+" and email "+C)}else{clearHipaaPatient()}}function clearHipaaPatient(){$("hippaPatientId").value="";document.coverForm.coverNotifyEmail.value=""}function updatePatientId(B){log("Patient id updated to "+B);$("hippaPatientId").value=prettyAccId(B)}var isFireFox=(navigator.userAgent.indexOf("Firefox")!=-1);function openCcrWindow(C,E,B){if(E){log("Unhiding patient "+B);unhidePatient(B)}if(window.ccr){window.ccr.close()}if(isFireFox){var D=window.open("","ccr");D.close();window.setTimeout(function(){window.ccr=window.open(C,"ccr")},500)}else{window.open(C,"ccr")}return false}function authQueryString(C){var B=queryString(C);B+="&enc="+urlEncode(hex_sha1(getCookie("mc")));return B}function saveConsents(){var B=authQueryString(document.consentsForm);execJSONRequest(document.consentsForm.action,B,function(C){if(C.status=="ok"){alert("Consents saved successfully!")}else{alert("A problem occurred while saving your consents:\r\n\r\n "+C.message);window.location.reload()}})}function fillConsentGroup(B,C){forEach(document.consentsForm.getElementsByTagName("tr"),function(D){if(D.id&&D.id.match(new RegExp(B+".[0-9]{16}"))){forEach(D.getElementsByTagName("option"),function(E){E.selected=(E.value==C)})}})}var portNumber=true;var baseURL="http://localhost:16092/";function initContextManager(){appendChildNodes(document.body,DIV({style:"display:none"},createDOM("iframe",{id:"ctxf1",name:"contextFrame"}),createDOM("iframe",{id:"ctxf2",name:"loadFrame"})))}function setAuthorizationContext(B){setContextURL(baseURL+"setAuthorizationContext?accountId="+B);return(true)}function loadDocument(E,C,G,D,B,F){downloadDocumentAttachments(E,C,G,D,B,F)}function setDocumentFocus(E,C,G,D,B,F){setContextURL(baseURL+"setDocumentFocus?storageId="+E+"&guid="+C+"&cxpprotocol="+G+"&cxphost="+D+"&cxpport="+B+"&cxppath="+F);return(true)}function downloadDocumentAttachments(E,C,G,D,B,F){setContextURL(baseURL+"downloadDocument?storageId="+E+"&guid="+C+"&cxpprotocol="+G+"&cxphost="+D+"&cxpport="+B+"&cxppath="+F);return(true)}function setAccountFocus(I,C,H,E,D,B,G,F){setContextURL(baseURL+"setAccountFocus?accountId="+I+"&auth="+E+"&groupAccountId="+C+"&groupName="+H+"&cxpprotocol="+G+"&cxphost="+D+"&cxpport="+B+"&cxppath="+F);return(true)}function clearAuthorizationContext(){setContextURL(baseURL+"clearAuthorizationContext")}function clearDocumentFocus(){setContextURL(baseURL+"clearDocumentFocus")}function setContextURL(B){if(!window.contextFrame){initContextManager()}contextFrame.location.href=B};